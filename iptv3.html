<!--
電視兒童
設定:
	捷徑用 --app
	自動播放且有聲音,要加系統註冊碼 HKLM\Software\Policies\Google\Chrome\AutoplayAllowed=1
	無法播放影片狀態:1.連結錯誤, 2.上層為本機路徑時
使用:
換台:PgUp/PgDn
音量:iframe內建,Up/Dn/m可作動, 但頁面載入後須點擊iframe才有效。
FullScreen全螢幕屬browser功能,無內建, 事件放在body。 另加放iframe無效,可能被覆蓋。esc結束全螢幕。

記錄音量/頻道...
頻道直選/自訂頻道
非youtube系統
子母畫面

待處理
	select 選單超出div, 看不到。
-->
<html><head>
	<title>iptv3</title>
<style>
	body::-webkit-scrollbar {
    	display: none;			/*隱藏body層次的滾動條*/
	}
	
	#player {					
		pointer-events: none;	/*設定對滑鼠不反應。
								結果游標不會消失,也不能點畫面的連結不能關廣告(播放結束時)
								因為用滑鼠點過畫面後,按鍵全失效, 包含youtube的。
								*/
	}
</style>

   </head>
<body topmargin="0" leftmargin="0" 
	onload="init();" 
	onkeydown="doKeyDown(event);" onclick="stop();"
	onkeydown_="doKeyDown(event);" ondrop="alert('沒反應!');"
	onmouseover="dspCtrlPal('block')" onmouseleave="dspCtrlPal('none')">

<div id="btnGrp" style="display:none; position: absolute; z-index:1;background:#737373;"
	onclick="event.stopPropagation();">
	<button onclick="volume(-7);" title="按鍵 down">vol-</button>
	<button onclick="volume(3);">vol+</button>
	音量:上/下, 靜音:M
	<br>
	<button onclick="ch(-1);" title="按鍵 left">ch-</button>
	<button onclick="ch(1);">ch+</button>
	 選台:左/右
	 <br>
	 <button onclick="window.resizeTo(scrWs,scrHs);" title="key -">z-</button>
	<button onclick="window.resizeTo(scrWm,scrHm);" title="按鍵 +">z+</button>
	 尺寸:加/減/F
	 <br>
	 播放/暫停: space key 或滑鼠點畫面
	 <br>
	 路徑:<input id="ytID" type="text" value="a"/>
	 <button>go</button>
	<!-- select id="scrModeSe" onchange="scrModeCh();">
		<option value="0">自動</option>
		<option value="1">小</option>
		<option value="2">中</option>
		<option value="3">全螢幕</option>
	</select -->
</div>

<div style="position:relative;width:100%;padding-bottom:56.25%;">
  <iframe id="player" style="position:absolute;width:100%;height:100%"
  
  src="https://www.youtube.com/embed/XxJKnDLYZz4?enablejsapi=1&fs=0&modestbranding=1&controls=0&disablekb=1"></iframe>
</div>
</body>


<script src="https://www.youtube.com/iframe_api"></script>
<script>
  var player;
  var myiframe;
  var scrMode = "0";
  //var vol = 13;
     var scrW = window.screen.availWidth;
	   var scrWs = scrW/4;
	   var scrWm = scrW/2;
	   var scrHs = scrWs * 0.64;
	   var scrHm = scrWm * 0.60;
	var currentCh = 8;
	
	const CHANNEL_NO=0;
	const CHANNEL_ID = 1;
	const CHANNEL_TITLE=2;
/*影片來源:
	a.youtube,以videoID表示,a1直播, a2單片
	b.獨立網址,直播
*/			
	var channelList = [
		{channel:13, title:"台視",	ytID:"xL0ch83RAK8"},
		{channel:13, title:"中視",	ytID:"TCnaIE_SAtM"},
		{channel:13, title:"華視",	ytID:"yUTy1U1wTwE"},
		{channel:13, title:"公視",	ytID:"JAzRXylm3M0"},

		{channel: 0, title:"壹電視",ytID:"x"},
		{channel: 0, title:"年代",	ytID:"x"},

		{channel:51, title:"東森",	ytID:"R2iMq5LKXco"},
		{channel:52, title:"中天",	ytID:"XwzkihjzsTM"},
		{channel:53, title:"民視",	ytID:"XxJKnDLYZz4"},
		{channel:54, title:"三立",	ytID:"FoBfXvlOR6I"},	//pJ0VgJloR9E
		{channel:55, title:"TVBS",	ytID:"V0WxUakDV7M"},
		{channel:56, title:"TVBSHD", 	ytID:"hP6_jfCFxyQ"},
		{channel:57, title:"東森財經",	ytID:"x"},
		{channel:58, title:"非凡",  ytID:"x"},
		
		{channel:99, title:"飯思思",ytID:"rzBp10kx5Lw"},
		{channel:99, title:"黃霄雲",ytID:"3A4cxRJyEBo"},
		{channel:99, title:"小施",	ytID:"6wNZyZEziL0"},
		{channel:99, title:"蜜雪薇琪_獨立", ytID:"pSKK7JYeFoQ"},
		{channel:99, title:"殷悅_揮之不去", ytID:"WK19HOgLjg8"}
		];

 function init(){
  	window.resizeTo(scrWm, scrHm);
	myiframe = document.getElementById('player');
	//myiframe.focus();
	
	window.addEventListener('online', () => {
		player.playVideo();
	});

}
function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
	videoId:"XxJKnDLYZz4",
	playerVars:{	//網址列的參數才有作用???
      //autoplay:1,
     controls:0,				//隱藏齒輪含「訂閱」圖示。
	  fs: 0,                  	// 隱藏全螢幕按鈕
	  iv_load_policy: 3,      	// 隱藏影片註解(沒效)
	  modestbranding: 1,      	// 隱藏YouTube Logo, 但滑鼠移入才會出現
	  disablekb:1,				//關閉鍵盤功能,
	  rel:0 						//播放結束不要顯示相關影片預設為1
	  // loop=1循環播放,預設值為0(即不循環)
	  //border]設定是否顯示影片的外框，值為0或1，預設值為0(即不顯示)
      //start:30
    },
      events: {
        'onReady': onPlayerReady
      }
    });
}
  
function onPlayerReady(e) {
	ch(8);
	e.target.playVideo().unMute();
	e.target.setVolume(17);	//初始音量
}

function volume(flag){
	player.setVolume(player.getVolume() + flag);
}

function ch(flag){
	if(Math.abs(flag) == 1){
		currentCh += flag;
	}else{
		currentCh = flag;
	}
	embedID = channelList[currentCh].ytID;
	player.loadVideoById(embedID);
	document.title = channelList[currentCh].channel + "_" + channelList[currentCh].title;
	document.getElementById("ytID").value = channelList[currentCh].ytID;
}
  
function stop() {
	state = player.getPlayerState();
	if(state == 1){
		player.pauseVideo();
	}

	if((state == 2) || (state ==-1)){
		player.playVideo();
	}
}

function dspCtrlPal(mode){	//display Control Panel
	document.getElementById("btnGrp").style.display = mode;
}
	
function zoon(flag){
//TODO:視窗最大化時沒反應
//尺寸為1/8~7/8,全螢幕
}
	
function scrModeCh(){
	scrMode = document.getElementById("scrModeSe").value;
	switch (scrMode) {
	case "0":
	　break;
	case "1":
	　window.resizeTo(scrWs,scrHs);
	　break;
	case "2":
	//alert(scrWm + "," + scrHm);
	  window.resizeTo(scrWm,scrHm);
	　break;
	case "3":
		document.getElementById("scrModeSe").value = "1";
		scrMode = "1";
	　 myiframe.webkitRequestFullScreen();
	　break;
	default:
	　x="沒有符合的條件";
	}
	//prescrMode = scrMode;
}

function drop_handler(event) {
	alert("event");
	event.preventDefault();	//避免瀏覽器對資料的預設處理
	// Get the id of the target and add the moved element to the target's DOM
	var data = ev.dataTransfer.getData("text");
	alert(data);
	//ev.target.appendChild(document.getElementById(data));
}

function doKeyDown(event){
	//event.stopPropagation();		//中止氣泡
	//event.preventDefault();			//取消預設的行為(只擋住F1。F/Ctrl+/Ctrl-都擋不住)

	//alert(event.keyCode);
   switch (event.keyCode){
	case 32:	//<SPACE>
		stop();
		break;
/*
	case 33:	//<PgUp>
		ch(-1);
		break;
	case 34:	//<PgDn>
		ch(1);
		break;
	*/	
	case 37:	//<Left>
		ch(-1);
		break;
	case 39:	//<Right>
		ch(1);
		break;
	case 38:	//<Up>
		volume(3);
		break;
	case 40:	//<Dn>
		volume(-7);
		break;
	//空白鍵,暫停
	case 27:	//<ESC>
		document.getElementById("btnGrp").style.display = 'none';
		break;
	case 72:	//<H> forHelp
	case 112:	//<H> forHelp
		document.getElementById("btnGrp").style.display = 'block';
		break;
	case 187:	//<+>
		window.resizeTo(scrWm,scrHm);
		break;
	case 189:	//<->
		window.resizeTo(scrWs,scrHs);
		break;
	case 77:	//<M>
		if(player.isMuted()){
			player.unMute();
		}else{
			player.mute();
		}
		break;
	case 34:	//<PgDn>

		break;
   	case 70:	//<F>
             //alert("F");
		if(scrMode == "0"){
			document.getElementById("scrModeSe").value = "1";
			scrMode = "1";
		}
		myiframe.webkitRequestFullScreen();
	//無法取得解除全螢幕的事件
				    break;
	default:
				}
	}

</script>
</html>
