<!doctype html>
<html lang=zh_tw.UTF-8 manifest="index.manifest">
<head>
	<meta charset="utf-8">
	<!-- 程式來源 https://blog.xuite.net/gkyo0510/wretch/242769650 -->
	<title>GPS02-2</title>
</head>

<style>  
	.cmdButton {
		width:200px;
		height:200px;
		border-width:3px;
		border-style:dashed;
		border-color:#FFAC55;
		padding:5px;
		
		text-align:center;	//水平置中
		top:0px;
		line-height:200px;//文字垂直置中(行高等於容器高度),單行適用
	}
</style>  

<body onload="init();" bgcolor="black" text="white" margin="0">
	<f function HTML_body(){}/>
	<a>v0.82b86</a>
	<div style="display:none">
		<input type="button" value="測試" onClick="test03();">
		<a href="index.html">穩定版</a>、
		<a href="indexb.html">測試版</a>
	<br>
	</div>
	<canvas id="canvas"></canvas>
	<font size="7">
	<div style="display: flex; justify-content: flex-end;">
		<div class="cmdButton" onclick="addLog('尋標(手動)');nearPoint();" >尋標</div>
		<div class="cmdButton" onclick="insertCoord('急彎');">急彎</div>  
		<div class="cmdButton" onclick="insertCoord('測速');">測速</div>
		<div class="cmdButton" onclick="">o</div>
		<div class="cmdButton" >
			<div id="march" onclick="swColor();" style="font-size: 150px;">0</div>
		</div>
	</div>
		
	<p id="posStr">111222</p>
	</font>
	<font size="6">
	<p id="watchStr">監控狀態</p>
	</font>
	<input type="checkbox" id="touchSW" checked>觸控
	<input type="button" value="GPS啟動" onClick="startGPS();">
	<input type="button" value="GPS停止" onClick="stopGPS();">
	<input type="button" value="更新快取" onClick="newCache();">
	<input type="button" value="通知測試" onClick="displayNotification();">
	
	<input type="button" value="清除" onClick="ins.innerHTML='';localStorage.insertCoord='';">
	<input type="button" value="匯出" onClick="exportCoord();">
	<input type="file" multiple id="input" style___='display:none;'>
	
	<p id="insertCoord"></p>
</body>
<script defer>
	//defer:資源載入後才執行, async同, 但不保證照順序, 空白則立即執行,
	//等同 window.addEventListener('load', function() {...}
    if ('serviceWorker' in navigator) {
		navigator.serviceWorker.register('sw.js')	//參數scope設定掌管範圍, 預設為???
		.then(reg => console.log('完成 SW 設定!', reg))
            .catch(err => console.log('Error!', err));
		//sw.js須為獨立檔案, 無法把程式全部塞在一個檔案。
		
		navigator.serviceWorker.addEventListener("message", function(event) {
			showMsg(event.data);
		});
    }
</script>
<script>
//TODO 到指定網站下載gps檔(並cache)
function var_tasks(){ }//本行給notepad++的函式清單用(大引號不可靠在一起)
var tasks = [[
[22.687819705814334, 120.49071790694966, "屏市廣東路_公裕街"],
[22.687402189056910, 120.49206250775707, "信義路",,"s"],
[22.686729192240975, 120.49421425500697, "北興街"],
[22.686447538895283, 120.49495951297570, "彎2"],
[22.686019247344202, 120.49553921680779, "中正路"],
[22.685419640039880, 120.49618971684767, "中華路"],
[22.684124191531676, 120.49765721344495, "華正路"],
[22.683493730273277, 120.49835715263679, "仁愛路"],		
[22.681135369442668, 120.50103519150333, "大連路","號誌",,"號誌"],
[22.680503680227538, 120.50166215785417, "468巷","號誌",,"號誌"],
[22.680016661529510, 120.50172601825584, "456巷","號誌",,"號誌"],
[22.677094620745510, 120.50092146003797, "建豐路","號誌",,"號誌"],
[22.676454250884152, 120.50072968208876, "勝利路","號誌",,"號誌"],
[22.676016199057848, 120.50058752501798, "高豐街","號誌",,"號誌"],
[22.674161811466448, 120.49996566902554, "民學路","號誌",,"號誌"],
[22.671873370117144, 120.49922917511516, "公園路","號誌",,"號誌"],
[22.671026831904392, 120.49895754739023, "林森路","號誌",,"號誌"],
[22.670303645732268, 120.49872383267650, "民和路","號誌",,"號誌"],
[22.669749249959157, 120.49854948908974, "師校巷","號誌",,"號誌"],
[22.668284679096782, 120.49808161964651, "民利路","號誌",,"號誌"],

[22.667523721107013, 120.49783069348910, "民生路","號誌","s","號誌"],
[22.666146373148113, 120.49682535519977, "永興巷","號誌",,"號誌"],
[22.665668426461390, 120.49611878921134, "民有一路","號誌",,"號誌"],
[22.664494457244020, 120.49398889788802, "台糖三街","號誌",,"號誌"],
[22.664538486498530, 120.49275854991020, "台糖二街","號誌",,"號誌"],
[22.664719066900550, 120.49111327623315, "台糖一街","號誌",,"號誌"],
[22.664921862823768, 120.49002489997704, "仁愛路","號誌",,"號誌"],
[22.665244293437960, 120.48848746967730, "復興路","號誌",,"號誌"]
],[

[22.687402189056910, 120.49206250775707, "屏市信義路_廣東路"],
[22.683254926773614, 120.49063028957730, "自由路"],
[22.679283425604222, 120.48939080426767, "勝利路",,"s"],
[22.674985859155086, 120.48800726449655, "公園路"],
[22.674140007969516, 120.48770531987410, "林森路"],
[22.673580000235486, 120.48697672493849, "上海路"],
[22.673109063305805, 120.48572575929995, "中山路"],
[22.671400844866110, 120.48121792159768, "柳州街"],
],[

[22.679516372513962, 120.48845077110741, "勝利路_忠孝路"],
[22.679283425604222, 120.48939080426767, "信義路",,"s"],
[22.678848026533156, 120.49098285477106, "中正路"],
[22.678610736856214, 120.49196844236240, "中華路"],
[22.678454822713874, 120.49290252166726, "長春街"],
[22.678104404717550, 120.49473692862567, "仁愛路"],
[22.677878365098260, 120.49559583741438, "大連路"],
[22.677433398468075, 120.49717838974670, "自由路",,"s"],
[22.676454250884152, 120.50072968208876, "廣東路"],
],[

[22.655681558333953, 120.46721365458004, "屏市建國路_和生建國東匣道口"],//去格上的路
[22.655978329239740, 120.46703190711366, "彎1"],
[22.656353326760172, 120.46697893349000, "彎2"],
[22.664743868219855, 120.47180160830916, "建國大豐路口"],
[22.666825373402850, 120.47302021376048, "大豐大興路口"],
[22.666975160728670, 120.47585913458741, "大興大同"],
[22.667106937756838, 120.47865365026702, "大興和平"],
[22.666242590336320, 120.48564809520727, "自由西段"],
],[

[22.664835913813217, 120.48302966568532, "屏市自由路_建國路"],
[22.665256831860140, 120.48351722083740, "彎景觀橋"],
[22.666242590336320, 120.48564809520727, "自由西段"],
[22.666925702267207, 120.48723395133844, "建華一路"],
[22.666706776631230, 120.48892405481610, "復興路"],
[22.666248950188640, 120.49045938580645, "仁愛路"],
[22.666117415059060, 120.49127656454485, "彎5"],
[22.666501518175608, 120.49211962339456, "萬全街"],
[22.668217739989800, 120.49406721401049, "彎7"],
[22.669217232940056, 120.49452720800143, "民生路",,"s"],
[22.671998171657794, 120.49540273715992, "林森路"],
[22.672831599533172, 120.49571917756099, "公園路"],
[22.677433398468075, 120.49717838974670, "勝利路",,"s"],
[22.679237320824154, 120.49776103483836, "大連路"],
[22.680502454450863, 120.49577244737631, "仁愛路"],
[22.681408130711468, 120.49438452773967, "長春街"],
[22.682178417608940, 120.49315824445517, "中華路"],
[22.682777925988160, 120.49221378743114, "中正路"],
[22.683249719600827, 120.49063886988985, "信義路",,"s"],
[22.683582637091725, 120.48933785500037, "忠孝路"],
],[

[22.671514282669950, 120.47831773942440, "屏市民生路_民族和平路口","號誌",,"號誌"],
[22.670291616624766, 120.48641973828960, "民族中正路口","號誌",,"號誌"],
[22.671130623215370, 120.48921382369929, "民生逢甲路口","號誌",,"號誌"],
[22.670393568659800, 120.49122460092052, "民權路"],
[22.670088606468810, 120.49209548031308, "仁愛路"],
[22.669222036792192, 120.49452819798431, "自由路","號誌","s","號誌"],
[22.669049328652985, 120.49498868304266, "自立路"],
[22.668690566737276, 120.49578050428205, "民和路"],
[22.667523721107013, 120.49783069348910, "廣東路G50R40","號誌","s","號誌"],

[22.666651112033670, 120.49936391934412, "民教路G60R40"],
[22.666087264583700, 120.50037043288955, "工業路G60R40","號誌",,"號誌"],
[22.665707901738443, 120.50104240415410, "69巷","路口"],		
[22.665284665992060, 120.50179543433640, "殺蛇溪", "號誌"],
[22.665066241181687, 120.50217027304704, "民福路G60R40",,,"號誌"],
[22.664221944275300, 120.50369274070279, "民生校區"],
[22.663392101851596, 120.50520911909595, "菸廠路"],
[22.662795198326197, 120.50622976219097, "瑞民路(速限50北路邊)",,,"測速"],		
[22.662224935354054, 120.50727471537175, "歸仁路G50R40", "號誌",,"號誌"],
[22.660786453149907, 120.50977011409931, "瑞屏街中油"],		
[22.659908488349370, 120.51121889337335, "和生路G60R40"]
],[

[22.659470893607228, 120.51209569251994, "屏市田中巷_安心四橫巷"],
[22.659826699053390, 120.51235318458225, "田中巷口"],	
[22.659564120626770, 120.51307269832040, "二橫巷"],
[22.659505837597436, 120.51438338176050, "2-10號"],
[22.659390282100908, 120.51514639840148, "瑞光路口"],
],[

[22.697565692997600, 120.49934616305569, "屏市瑞光路_忠孝路"],
[22.695365552118485, 120.50067696876555, "391巷"],
[22.692573806644400, 120.50228411988692, "中正路", "路口","s","路口"],//右彎用
[22.689404000290573, 120.50339964016158, "華新路"],
[22.687119793082346, 120.50397282994732, "華正路"],
[22.686598018178778, 120.50410345276488, "華富路"],
[22.684895510635690, 120.50453366820194, "17弄", "號誌",,"號誌"],
[22.682967504306080, 120.50505775656028, "大連路", "號誌",,"號誌"],

[22.680967230062606, 120.50559870461440, "彎60"],
[22.679781531852086, 120.50662226896395, "146巷", "號誌",,"號誌"],
[22.678966094896705, 120.50732545840168, "興豐路", "號誌",,"號誌"],
[22.676452289680334, 120.50955647049913, "建豐路R40", "號誌",,"號誌"],
[22.675343791402256, 120.51041230398191, "彎40"],
[22.673650031059577, 120.51056656006223, "田寮巷", "號誌",,"號誌"],
[22.670996612762544, 120.51062443057785, "民學路", "號誌",,"號誌"],
[22.669040797908576, 120.51069667037709, "彎30(愛家)"],
[22.665190350620573, 120.51312797662538, "香揚巷口", "號誌",,"號誌"],
[22.661457518466925, 120.51546704670002, "彎20"],
[22.660425394728480, 120.51532207450000, "單車道"],
[22.659389590906848, 120.51514906227330, "田中巷口",,"s"],
[22.658633168724144, 120.51504245069331, "彎(急診室)"],
[22.658030217493362, 120.51462891662300, "國仁路口",,"s"],

[22.655579780727386, 120.51407578585876, "彎10"],	//瑞光南路
[22.654285266265962, 120.51290058024507, "歸智巷G50R35"],
[22.653399707004777, 120.51195347112373, "民生東路11巷G50R35"],
[22.652150360224123, 120.51053770124854, "瑞光路_歸禮巷G50R35"],
[22.647793418681097, 120.50587508711462, "鐵路G50R35"],
[22.641916924752300, 120.49835011659876, "頂柳路G50R35"],
[22.639680150002107, 120.49160802216821, "中柳30巷G50R35"],
[22.638755163033025, 120.48856513293333, "OX巷G50R35"],
[22.638548839801203, 120.48552391553939, "台27(左轉停紅燈)"],
],[

[22.640458409110163, 120.48558243388611, "台27屏市_中柳路"],
[22.638548839801203, 120.48552391553939, "瑞光南路",,"s"],
[22.637290288656953, 120.48548643556340, "41巷"],
[22.634564819716747, 120.48522488341776, "大湖路"],
[22.620744245553347, 120.48246845126806, "屏48"],
[22.619037673163817, 120.48212565170694, "測速60南路中","測速"],
[22.618206538887500, 120.48208348992766, "萬丹路"],
[22.612146053133856, 120.48515490832058, "大昌路(社皮)"],
[22.609809438086018, 120.48645616068083, "西勢尾街"],
[22.606215071002932, 120.48742775321385, "廣維路"],
[22.602767076674350, 120.48827422944480, "丹榮路(外環左2,綠燈後段)"],
[22.599417478349690, 120.49108799566446, "31巷"],
[22.597246432443807, 120.49279619173203, "彎3(台電)"],
[22.595274999880196, 120.49298735940094, "四維東路"],
[22.591925550761868, 120.49269825799061, "萬榮街"],
[22.589722065447027, 120.49233954121459, "測速70北路中",,,"測速"],
[22.588828516216864, 120.49221868440955, "大學路(內埔往東)",,"s"],//炸菜丸
[22.586012918750356, 120.49346585629661, "彎3"],
[22.585650529393310, 120.49344009428454, "萬壽路(189往潮州)"],
],[

[22.588462881419062, 120.49145711684999, "大學路_成功街"],
[22.588828516216864, 120.49221868440955, "丹榮路",,"s"],//炸菜丸
[22.591555876756765, 120.49799472111913, "彎"],
[22.596912231890006, 120.51533627334615, "萬竹路"],
],[

[22.692732317780546, 120.50245954225517, "屏市海豐_海豐街", "號誌",,"號誌"],
[22.695511971450234, 120.50541611177160, "盛豐路", "號誌",,"號誌"],
[22.696883960767217, 120.50906180826027, "18巷R30", "號誌",,"號誌"],
[22.697223595825060, 120.51001791729799, "彎23"],
[22.697520399914552, 120.51273661749624, "彎27"],
[22.698434438925595, 120.51448625249280, "XX巷", "號誌",,"號誌"],
[22.700634859974850, 120.51823386201329, "彎47"],
[22.701582376471514, 120.51924180789028, "彎57"],
// [22.701152592239588, 120.51891439357674, "彎道"],
[22.702393890430030, 120.51959361288017, "測速北60路中","測速"],
[22.702703598302563, 120.51973392246246, "屏34", "號誌",,"號誌"],
[22.705400301590082, 120.52084164949027, "屏XX", "號誌",,"號誌"],
[22.706893006935474, 120.52142952458101, "彎水溝"],
[22.708802614179150, 120.52199195978083, "德和路台27", "號誌",,"號誌"],
[22.715148652002400, 120.52903378461157, "國道下R100G前30秒右轉", "號誌","s","號誌"]
],[

[23.520061183314333, 120.48470246368550, "國3_竹崎290k"],
[23.450712810503850, 120.48482435360481, "中埔297k"],
[23.445973236165496, 120.48292544363785, "匣道中埔北出",,"s","交流道"],
[23.428426834321836, 120.46796253994576, "水上系統300k(台82)"],

[23.347261953768577, 120.43948351735621, "白河311k"],
[23.342896729384670, 120.43877249044634, "匣道白河北出(南172)",,"s","交流道"],
[23.329624907100230, 120.43216108015400, "測速南313.7k白河收","測速"],
[23.296923372435128, 120.40465436441492, "測速北318.7k",,,"測速"],
[23.288115881113587, 120.39725679818166, "東山休319k"],
[23.270976893578400, 120.37879506296973, "柳營322k"],
[23.263393384663090, 120.37606985717822, "輔165"],
[23.260009908510740, 120.37624857190467, "匣道柳營北出",,"s","交流道"],//結束點
[23.212595587038756, 120.35597978481790, "六甲329k"],
[23.200949352616856, 120.35551792420067, "測速北331K",,,"測速"],
[23.166488394497204, 120.35211069151072, "官田系統334k(台84)"],

[23.123680009773498, 120.33163907200299, "善化340k"],
[23.106145617196557, 120.32773179091218, "測速南342.1k善化收","測速"],
[23.083334391223495, 120.32927656218750, "測速北344.7k",,,"測速"],
[23.064405390029275, 120.32385819692153, "新化系統346k"],
[23.056983157169460, 120.32171162860061, "新化系統北出(國8)",,"s","交流道"],//結束點
[23.031102013773342, 120.32747163097120, "新化休350k"],
[23.002538936297594, 120.32017197763913, "彎354k路橋"],
[22.981989290302370, 120.32137500437895, "關廟南出(台86)","交流道","s"],
[22.976988169199117, 120.32451457757003, "關廟357"],		//不算「系統」交流道
[22.974870863225824, 120.32682631164319, "彎11"],//尋標演算無方向時的輔助點
[22.973947774150542, 120.32848819487776, "關廟北出(台86)",,"s","交流道"],//結束點
[22.970843068872675, 120.33799371432511, "測速南358.6k","測速"],
[22.955135778841620, 120.35215292962923, "彎46"],
[22.928409690316805, 120.35144861748418, "關廟休363k"],

[22.880475806969113, 120.36053399604650, "田寮369k"],
[22.858868790871820, 120.37342920505114, "測速南372.3k田寮收","測速"],
[22.844973482678757, 120.38563347460189,"測速北374.3k",,,"測速"],
[22.826030483069918, 120.41562147126878, "彎/中寮隧道北"],
[22.784742294477663, 120.42614378390690, "燕巢系統383k"],	
[22.767044225195598, 120.44657768105789, "測速南386k斜張北","測速"],

[22.757293359703990, 120.47697660868005, "測速北389.3k",,,"測速"],
[22.753587732979405, 120.49163925763379, "九如391k"],		
[22.715142111757505, 120.52903480114699, "鹽埔396k"],
[22.696340598015862, 120.55538995866570, "長治400k"],
[22.684934999438170, 120.56275716716313, "彎35"],
[22.649472490671410, 120.54458304350727, "匣道麟洛南出","交流道","s"],//結束點
[22.649454922551800, 120.54452591327700, "彎37"],	//同下
[22.647765223907760, 120.54336929208104, "彎38"],//角度識別前,為區別交流道與平面
[22.643608708111160, 120.54050184127057, "彎39"],//同上
[22.638461295240916, 120.53772076904290, "麟洛407k"],

[22.635816117406613, 120.53645008598258, "國3永豐路",,"s"],//匣道太靠近抓不到
[22.630349860257933, 120.53439522665516, "匣道_麟洛北出",,"s","交流道"],
[22.620415970291795, 120.53244467311063, "彎新勢路屏87"],
[22.589091457925857, 120.52460698935286, "彎42"],
[22.571460007993310, 120.52805817563673, "竹田系統415k"],
[22.513298398226770, 120.52481622656578, "崁頂421k"],//屏70
[22.490733521666380, 120.52984122207067, "南州424.5"],
[22.478011059828116, 120.53140029243856, "彎77"],//三千路
[22.467005357151947, 120.52812964759863, "彎79"],//中華路
[22.457441865679897, 120.52050263077031, "彎81"],//小路
[22.445395497018193, 120.50586792409074, "林邊430k"],//台17
],[

[23.056983157169460, 120.32171162860061, "新化匣道_北出"],//結束點
[23.059916409900335, 120.32267430742243, "分向點"],//往西
[23.062615276558360, 120.32357832352301, "彎1"],
[23.064491081704848, 120.32289970857789, "彎2"],
[23.065142853230174, 120.32153940883586, "彎3"],
[23.064434035909688, 120.31710962787085, "併向點"],
[23.063921348179978, 120.31541380120660, "匯入點"],
],[

[23.064272352865288, 120.31766309674190, "新化匣道_東出"],
[23.064277559440786, 120.31997651166978, "分向點"],
[23.063531911139320, 120.32181315534062, "彎1"],
[23.060590893353023, 120.32221347033823, "併向點(車道縮減)"],
[23.058595659819957, 120.32179746986750, "匯入點"],
],[

[22.590234758772380, 120.35887808627760, "台88_鳳山2k鳳頂路"],
[22.586530088963677, 120.40513169145508, "大竂7k台25"],
[22.592124619464876, 120.42874828346483, "大發9k華中路"],
[22.570629394393060, 120.47854601285559, "萬丹15k"],
[22.571460007993310, 120.52805817563673, "竹田系統21k"],
[22.571282340989175, 120.53368285413669, "匣道竹田西出",,"s"],
[22.568919977549610, 120.54004637062756, "屏85(左2右1)"],
],[

[22.576377058385205, 120.52721939120937, "匣道竹田_竹田北入"],
[22.574118708691735, 120.52799836196351, "分叉點"],
[22.571848603899790, 120.53072768591808, "分叉點"],
[22.571282340989175, 120.53368285413669, "竹田西出"],
],[

[23.260009908510740, 120.37624857190467, "匣道柳營_北出往東"],//結束點
[23.261202550293210, 120.37633179963355, "燈4"],
[23.269928928011250, 120.37949694253497, "匯入點"],
],[

[23.267914940257890, 120.38048922441678, "德元埤大道_165路口G30R40"],
[23.270640661442556, 120.37911153935258, "號誌"],
[23.271286514918128, 120.37839753831910, "匣道入"],
[23.268378755521010, 120.37694500227619, "彎2"],
[23.264660369719287, 120.37585057981457, "彎3"],
[23.260984148045015, 120.37597297819813, "匣道柳營南下匯入點"],
],[

[22.649472490671410, 120.54458304350727, "匣道麟洛_南出"],//結束點
[22.648871967617648, 120.54400312679464, "彎1"],
[22.647870943228924, 120.54325403791405, "彎2"],
[22.643702797709295, 120.54051434849620, "彎3"]
],[

[23.553463502495900, 120.41575260224359, "國1_民雄257k"],
[23.494853866352237, 120.39151776091767, "嘉義264k"],
//測速北261.7大
[23.490195025817170, 120.38773327141976, "匣道太保北出",,,"交流道"],//結束點
[23.444469495481073, 120.36693865260786, "水上270k"],
[23.424581019743666, 120.35661493424698, "嘉義系統272k(台82)"],
//南276.2,
[23.384750100091520, 120.35490877975793,"測速照相北277.3","測速"],	
// 南279,		
[23.382224009733400, 120.35422460954936, "彎陸橋南84"],
[23.358034919658710, 120.33825254669834, "新營收費站"],
[23.339912448572896, 120.31214231750390, "新營休284k"],
//測速北284.1
[23.331982310060680, 120.30501881737331, "測速南285.3k","測速"],
[23.307324644464350, 120.29080890577876, "新營288k"],
[23.276397443199087, 120.26939895183537, "測速北292.5k",,,"測速"],
[23.271993345181720, 120.26515917575410, "測速南293.1k","測速"],
[23.219142537160913, 120.23911067598834, "下營系統299k(台84)"],
[23.201338264985267, 120.23635636202462, "測速南301.6k","測速"],
[23.201872716698144, 120.23668252747801, "測速北301.5k",,,"測速"],//離上一點太近
[23.191613212788408, 120.23620573095596, "麻豆南出","交流道"],
[23.182400329087255, 120.23565584201334, "麻豆303k"],
[23.161191707112035, 120.23099243969990, "測速南306.1k","測速"],
[23.134542623000353, 120.23611254383980, "測速北309.1",,,"測速"],
[23.117642743896905, 120.24356043591008, "安定311k"],
[23.085050394962483, 120.25136299734912, "台南系統南出","交流道","s"],
[23.079167471361096, 120.25221238322186, "台南系統315k(國8)"],
//測速南315.5k
[23.041946983666293, 120.25145678714567, "永康319k"],
//測速南321.8k
//測速北323.4
[23.003008726296116, 120.24810377094597, "大彎324k復國二路16巷"],
[22.972177930727260, 120.24939759796331, "仁德327k&327A北出"],
[22.935994105128767, 120.25239568604870, "仁德系統330k北出",,,"交流道"],
[22.914948593133833, 120.26172570859070, "測速北334k",,,"測速"],
[22.905741290349840, 120.26585983467193, "仁德休335k"],
[22.892223406291862, 120.27244880447584, "測速北336.7k",,,"測速"],
[22.879590258074288, 120.27919940703470, "路竹338k"],
[22.845846254754292, 120.29533511565590, "高科342k"],
[22.812226242941332, 120.31425831237283, "岡山收"],
[22.787835475149280, 120.32063020173459, "岡山349k"],
[22.754916712572070, 120.33354986728632, "測速北353.3k",,,"測速"],
[22.741972146630590, 120.33442106621140, "楠梓南出","交流道"],
// [22.737139874816485, 120.33445440802357, "楠梓北356k(台22)"],
[22.720951653249130, 120.33240548078585, "楠梓南356K(高183)"],
[22.675247074423822, 120.32899256604684, "鼎金系統362(國10)"]
//測速北373.4
],[

[23.490195025817170, 120.38773327141976, "匣道太保_北出"],//結束點
[23.491856273794603, 120.38921696233113, "分向點"],//右東左西
[23.495295847694270, 120.39218408118430, "分向點"],
[23.495651779578870, 120.39307021619520, "彎1"],
[23.494790324478814, 120.39343144670175, "彎2"],
[23.494548754401652, 120.39265786539198, "匯入點"]
],[

[23.495520995968420, 120.38875367655419, "匣道太保_東入往南"],
[23.495085928040066, 120.38906875344426, "彎1"],
[23.493236055725340, 120.38939045520927, "彎2"],
[23.492599684932998, 120.38914709368126, "併向點"],
[23.490059124912996, 120.38731361266811, "匯入點"],
],[

[23.495297243691383, 120.39054344543918, "匣道太保_西入往南"],
[23.495882265330433, 120.39043548620428, "彎1"],
[23.496285613791695, 120.39101739484260, "彎2"],
[23.495830019574510, 120.39188856231878, "彎3"],
[23.495415273877335, 120.39168596599792, "叉併點"],//左側來車
[23.494396576374907, 120.39075284914100, "分叉點"],//左一
[23.492599684932998, 120.38914709368126, "叉併點"],//同前
],[

[23.085050394962483, 120.25136299734912, "匣道台南系統_南出"],
[23.082564032748760, 120.25130136570212, "分向點"],//往東
[23.078796468386130, 120.25185492767447, "彎1"], 
[23.077499895057920, 120.25086546161859, "彎2"], 
[23.078148425793670, 120.25025224947666, "彎3"], 
[23.078992850807700, 120.25156548637685, "彎4"], 
[23.078098193715500, 120.25613765607560, "併向點"],
[23.077780494075913, 120.25831485371570, "匯入點"],
],[

[23.498811449552825, 120.38288491422452, "北港路_南新里222巷"],
[23.498606326377900, 120.38520189457698, "中正路","路口",,"路口"],
[23.496301073474380, 120.38416099243679, "中興路","路口",,"路口"],
[23.496270565279907, 120.38631794807313, "彎10"],
[23.495520995968420, 120.38875367655419, "匣道東往南",,"s"],
[23.495297243691383, 120.39054344543918, "匣道西往南",,"s"],
[23.494853496860227, 120.39151641293120, "交流道下"],

[23.492706322464482, 120.39599941250182, "竹子腳","號誌",,"號誌"],
[23.491956262844052, 120.39788090234289, "埤竹路R50","測速",,"號誌"],
[23.489943215651362, 120.40456492707779, "保福一路","號誌",,"號誌"],
[23.489334512692835, 120.40658318765735, "保福路","號誌",,"號誌"],
[23.487312021609970, 120.41327505915952, "朱子公廟","號誌",,"號誌"],
[23.486048001155880, 120.41739653616519, "大溪路R40","號誌",,"號誌"],
[23.485249060748945, 120.41994939762375, "北社尾路","號誌",,"號誌"],
[23.484369600623886, 120.42271417604084, "世賢路","號誌",,"號誌"],

[23.483283764854150, 120.42458870212080, "興逹路","路口",,"路口"],
//[23.483927683653253, 120.4250500420696, "泰X一街"],
[23.484635821373992, 120.42522095393483, "泰源二街","路口",,"路口"],
//[23.484780203725695, 120.42696779667376, "泰瑞四街"],
[23.484866693493874, 120.42777223992623, "四維路","號誌",,"號誌"],
[23.485099328820590, 120.43074953443690, "八德路","號誌",,"號誌"],
[23.485371164554195, 120.43350202929254, "友愛路","號誌",,"號誌"],
[23.485603254636477, 120.43598669750823, "建國路","路口",,"路口"],
[23.487700150305030, 120.43798908763151, "自由路","路口",,"路口"],
[23.484586211810406, 120.44207576963485, "博愛路","號誌",,"號誌"],
[23.482402669321180, 120.44483303135881, "彎22"],
[23.481954059682657, 120.44593703182586, "民生北路","路口",,"路口"],
[23.482156314107410, 120.44911616103315, "文化路","號誌",,"號誌"],
[23.482782321260510, 120.45247972217649, "民權吳鳯路口","號誌",,"號誌"],
[23.483027545683317, 120.45392515642074, "民權忠孝路口","路口",,"路口"],
[23.481572630028430, 120.45410415844404, "中山忠孝路口","號誌",,"號誌"],
[23.480747267033510, 120.45423290447764, "民樂街","路口",,"路口"],

[23.480615682196070, 120.45304999770407, "吳鳳北路","路口",,"路口"],
[23.481385310071623, 120.45289189851603, "吳鳳中山路口","路口",,"路口"],
[23.479998027679155, 120.44983872214250, "噴水池D2"],
[23.479905810607335, 120.44942608572478, "噴水池D9"],
[23.479614529944225, 120.44622713520200, "民生中山路口","路口",,"路口"],
[23.480566454376916, 120.44610458917927, "民生北榮街口"]
],[

[23.481572630028430, 120.45410415844404, "嘉市東_中山忠孝路口","號誌",,"號誌"],
[23.481828830294300, 120.45620328583118, "和平路"],
[23.482136995811430, 120.45877431121782, "維新路"],
[23.482410837860353, 120.46102419498591, "新生中山路口","路口",,"路口"],
[23.481550539745484, 120.46118872838522, "民樂街"],
[23.480833543498820, 120.46128090238894, "公明路"],
[23.480178424826770, 120.46137401912493, "中正路"],
[23.479480359424887, 120.46147015725076, "光彩街"],
[23.478729403071570, 120.46157250456743, "志航街"],
[23.477051523409350, 120.46172145903971, "新生民族路口"],
[23.476021690296893, 120.46159228850837, "朝陽街"],

[23.475014470294050, 120.46170745282507, "垂楊彌陀路口","路口",,"路口"],
[23.470769265865126, 120.46460606241318, "興業東路"],
[23.469031088634620, 120.46566798481935, "芳安路"],
[23.468203768052200, 120.46617677783940, "測速50北路中",,,"測速"],
[23.466204220558524, 120.46741761818838, "立仁路"],
[23.464571074581170, 120.46909223144600, "彎10"],
[23.464353478664750, 120.46956414907830, "測速50南路中","測速"],
[23.463957509859572, 120.47036506101428, "彎20"],
[23.462896922235420, 120.47110965894590, "堤防道路"],
[23.459378726343754, 120.47147406629810, "忠義大義路口","路口",,"路口"],
[23.458371532041370, 120.47365160943791, "彎33"],
[23.453429791666128, 120.47711731886149, "彎44"],
[23.451287808677645, 120.48008719477666, "大義中山路口","路口",,"路口"],
[23.450777726900412, 120.48367621181623, "匣道中埔南入",,"s"],
[23.450707271245832, 120.48482347296057, "國3下"],
[23.449944802528346, 120.48825255232322, "中埔交東_富裕路"]
],[

[23.445973236165496, 120.48292544363785, "匣道中埔_北出向西"],
[23.447977485507840, 120.48398696595447, "分叉點"],
[23.449803483717304, 120.48462882351217, "彎3"],
[23.451389418523807, 120.48548510676060, "彎5"],
[23.451697601442050, 120.48615841980897, "燈6"],
[23.451162061059860, 120.48677125462243, "燈8"],
[23.450561194009760, 120.48602575356952, "匯入點"],
],[

[23.450777726900412, 120.48367621181623, "匣道中埔_東入往南"],
[23.450482210963393, 120.48391755127635, "彎5"],
[23.450114493869187, 120.48394959316504, "交叉點"],
[23.445937137834736, 120.48261813461212, "匯入點"]
],[

[23.185141638951790, 120.24105368968476, "麻佳路_麻豆"],//去佳里烤乳豬
[23.182403335345820, 120.23565616778570, "麻豆交"],
[23.179799407691796, 120.23053900160443, "工業路"],
[23.176077727002706, 120.21233559290528, "車道縮減","車道縮減"],
[23.174856531744215, 120.20578556281740, "龍興路"],
[23.172443239296920, 120.20368427969782, "車道縮減",,,"車道縮減"],
[23.169344754648020, 120.20170156405410, "彎"],
[23.163948416334236, 120.18235471843579, "佳東路A"],
[23.165389855077912, 120.17815692521748, "延平路"],
[23.165718934097523, 120.17493202856102, "光復路"],

[23.163125179670626, 120.17480113865406, "佳里文化路"],
[23.162128254867287, 120.17478333728292, "和平街(日寶)","路口",,"路口"],
[23.159949546494530, 120.17474230261920, "新生路"],
[23.155127085993090, 120.17535125150587, "仁愛路(烤乳豬)","路口",,"路口"],
[23.154039981314654, 120.17822388277770, "勝利路"],
[23.151906875898580, 120.18429166612924, "台19_佳東路B","路口",,"路口"],
[23.143110019503420, 120.19226738006638, "南44"],
[23.138545848367894, 120.19571009815844, "南46"],

[23.127532112577300, 120.20202702873107, "新興街","路口"],
[23.125341523640007, 120.20272218610758, "南34"],
[23.122609215542610, 120.20307028308838, "西港文化路_南173"],
[23.121224241617547, 120.20330956078294, "慶安路"],
[23.119918047129250, 120.20353841567966, "綠川廊道"],
[23.117550419483656, 120.20388642230876, "忠孝街"],
[23.110558410156650, 120.20379938803494, "南40"],
// [23.1064023872731, 120.20573854832975, "西港大橋"
[23.096615435545832, 120.20949306426802, "南132"],
[23.089733294555394, 120.21015660371577, "台19_吉安路(國8迴轉)","路口"]
],[

[23.080413339742048, 120.19535923568306, "國8_公學路124巷"],
[23.089737062760300, 120.21015809275530, "新吉2k(台19)"],
[23.089499448870555, 120.21743863605131, "新吉西出",,,"交流道"],
[23.082599920383200, 120.23095059896585, "南133","號誌",,"號誌"],
[23.079168785750205, 120.25221556508849, "台南系統6k(國1)"],
[23.078220289328048, 120.2575214259908, "台南西出",,"s","交流道"],//結束點
// [23.077609137631313, 120.25920154055814, "彎30小路"],
// [23.073108379437986, 120.26745767566945, "彎50南135"],
[23.062056434287467, 120.28155653737717, "新市9k(台1)"],
[23.059269741329842, 120.28799388302116, "彎60高鐵"],
[23.058173258233108, 120.29758567339493, "彎44"],
[23.060515037038737, 120.30766898882672, "彎77小路"],
[23.064272352865288, 120.31766309674190, "新化東出(國3)","交流道","s"],//結束點
[23.064403971547915, 120.32385934603009, "新化系統14k(國3)"],
[23.061362280046982, 120.33187288965840, "新化端(台20)"]
],[
[23.078220289328048, 120.25752142599080, "匣道台南_西出"],
[23.079247619779450, 120.25566302694482, "分向點"],//往北
[23.082219732242446, 120.25273539582912, "併向點"],
[23.085242938125614, 120.25160602966307, "匯入點"],
],[

[23.345404983693710, 120.41235025821020, "南165_白河富民路"],
[23.336872237576667, 120.40643167850205, "彎15"],
[23.328567129804068, 120.40691515190440, "彎11"],
[23.326144721902410, 120.40515818697484, "東山所前路"],
[23.320630853564030, 120.40485361863810, "達雲路"],
[23.318507349252233, 120.40299714640597, "公園路口G25R50","號誌",,"號誌"],
[23.310624260069250, 120.40028523189007, "測速50南路旁","測速"],
[23.309411766504110, 120.39979334024561, "北馬彎北",,,"急彎"],
[23.307793557109218, 120.39991497924557, "北馬彎南","急彎"],
[23.305456147704284, 120.39805962214794, "彎3"],
[23.303166207007575, 120.39469089317613, "彎4"],
[23.302394381884290, 120.39275721478789, "彎2"],
[23.294939018382390, 120.38556569359515, "東河路口R20","號誌",,"號誌"],
[23.293512334998685, 120.38420249588806, "東河急彎"],
[23.291401183828448, 120.38333622903967, "彎6"],
[23.283454163556105, 120.38341696299390, "義士路口G35R25","號誌",,"號誌"],
[23.271978967066747, 120.38387977427587, "彎33"],
[23.270726464832290, 120.38336295538674, "旭山路口","號誌",,"號誌"],
[23.267914940257890, 120.38048922441678, "165路口G30R40","路口",,"路口"],
[23.265583997167980, 120.37828200077855, "南107"],
[23.258676953695932, 120.37161927501378, "彎34"],
[23.257944465103648, 120.37148049813736, "南165_果毅"]
],[

[22.635849179031137, 120.53125146842204, "屏東信義路_屏監"],
[22.640091466178593, 120.53628350941210, "台1路口", ,"s", "路口"],
[22.644163253922270, 120.54115889357361, "永豐路G30R40", "號誌"],
// [22.644365227087520, 120.54132916590225, "匣道口",,"s"],
[22.646887968356193, 120.54422751976801, "彎5"],
[22.650260226458116, 120.54568906280016, "民生路g40r40", "號誌","s","號誌"],
[22.655381953796578, 120.55160925823591, "科大路g30r60", "路口","s","路口"],

[22.663646264255550, 120.56134314763763, "建興路"],//以下往三和村
[22.666891513981340, 120.56515861511869, "和平路"],
[22.674742867871426, 120.57434980114600, "大旺路"],
[22.678661787166370, 120.57893609969561, "彎5"],
[22.682114853286210, 120.58047284563179, "彎9","急彎",,"急彎"],
[22.691459172095737, 120.59140611425790, "繁華路"],
],[

[22.691459172095737, 120.59140611425790, "繁華路_信義路"],
[22.690333300830826, 120.59254567298389, "三和路"],
[22.691707135361593, 120.59357153586593, "彎2"],
[22.693103168851927, 120.59589467283075, "彎10"],
[22.701382880999610, 120.60566992661147, "彎22"],
[22.708856558760424, 120.61983589245380, "路口"],
[22.712338762292887, 120.62639895088927, "台24"],		
],[

[22.656239829782194, 120.55051802107783, "屏東科大路_國3下"],
[22.655381953796578, 120.55160925823591, "信義路g30r60", "路口",,"路口"],
[22.653958635505553, 120.56099718185452, "南豐路g40r40","號誌",,"號誌"],
[22.652601671108002, 120.56930340677384, "彎33"],
[22.650020204517485, 120.57232527227198, "新生路g40r40","號誌"],
[22.649209527637070, 120.57317083867531, "新生路g40r30",,,"號誌"],
[22.644074768025085, 120.57842934867084, "測速60北路中",,,"測速"],
[22.643333748129898, 120.57925428694658, "大同路口g40r30","號誌",,"號誌"],
//[22.637113564621217, 120.58562488958711, "西銀巷"],
[22.634758245038586, 120.58804450981617, "科大北路G40R40/g20r70","號誌",,"號誌"],
[22.630047211459626, 120.59291416762996, "老埤路口R70G40", "路口",,"路口"],
],[

[22.630047211459626, 120.59291416762996, "壽比路_科大路g70r40", "路口",,"路口"],
[22.631652032656370, 120.59484811574646, "福泰路R25"],
[22.632378946529300, 120.59747736025373, "南山路"],
[22.633128880246172, 120.59797113670795, "安通路(超商)", "路口",,"路口"],
],[

[22.633128880246172, 120.59797113670795, "安通路_壽比路",,,"路口"],
[22.634391091432605, 120.60103048533080, "彎45廟"],
[22.633781195307613, 120.60403833875074, "彎40"],
[22.634897661413778, 120.60941335733453, "彎35"],
[22.633953055967723, 120.61298180239025, "彎30","路口",,"路口"],
[22.631294468978670, 120.61666081562409, "彎26",,,"急彎"],
[22.631997564921065, 120.61860851239224, "彎22"],
[22.628717830504170, 120.62638157350078, "沿山路G40R40", "路口",,"路口"],
],[

[22.631510070894457, 120.62602344736626, "沿山公路_排彎教會"],
[22.628717830504170, 120.62638157350078, "安通路G40R40", "路口",,"路口"],
[22.622106672183070, 120.62556054399592, "保安路G40R40", "號誌",,"號誌"],
[22.612465860711090, 120.62005262609880, "彎66"],
[22.604416359284045, 120.62024646947125, "營區路G40R40","號誌",,"號誌"],
[22.598582334698530, 120.62046577629641, "測速60南路邊","測速"],
[22.591721713708438, 120.62115374455101, "佳平路G40R40", "路口","s"],
// [22.580727045914188, 120.62226591938521, "台185_富山路屏106"]
],[

[22.543479244913740, 120.54496502965941, "潮州_中洲路光華路口(金弘)"],
[22.539540865449908, 120.54873107104940, "台1",,"s"],
[22.535080598518707, 120.55162337371588, "彭城路"],
[22.535205647798513, 120.55810461809310, "崙東路"],
[22.548445611284844, 120.57165615287434, "潮義路","號誌",,"號誌"],
[22.553980714834367, 120.57825255671523, "四春187乙"],
[22.571994762075730, 120.59449806612794, "佳佐消防隊(往左)"],
[22.573035539968720, 120.60028273558086, "佳佐光明路"],
[22.586503734859345, 120.61038474683005, "建興路屏101"],
[22.590608189788910, 120.61562222028402, "赤山樹"],
[22.591721713708438, 120.62115374455101, "沿山佳平路口"],
],[

//麟洛交下方的S路
[22.650260226458116, 120.54568906280016, "麟洛國1下_民生路g40r40"],
[22.650199358660190, 120.54539239896175, "彎1"],
[22.650234632232657, 120.54523079586696, "彎2"],
//[22.651404539183083, 120.5461149478058, "匣道_麟洛南出"],
],[	
																		//佳平到泰武部落
[22.590491294834035, 120.61556295866392, "屏120-1_屏99赤山"],
[22.591721713708438, 120.62115374455101, "佳平沿山路口",,"s","路口"],																		
[22.590483410935843, 120.62465695816196, "水泉山公園","急彎",,"急彎"],
[22.592155787378577, 120.63335669509607, "消防隊","急彎",,"急彎"],
[22.588965173008408, 120.63478577366980, "彎c21"],
[22.584632289571560, 120.63724489714178, "彎c22"],
[22.587393230911395, 120.63840873003024, "水溝蓋21下2","坑洞",,"坑洞"],
[22.589729480619960, 120.63908090610973, "築夢園"],
[22.588005635151926, 120.64152624879210, "彎c23"],
//[22.59124879239625, 120.64225222333936, "彎c24"],

//[22.588014368343007, 120.64156029481664, "彎r3"],

[22.591261095294808, 120.64224973638173, "彎r4"],
[22.587764544473860, 120.64637982864548, "彎r5"],
[22.588052532192496, 120.64697919856708, "112基地"], 
[22.590076597989340, 120.64766077466638, "橋","急彎",,"急彎"],
[22.584851943211078, 120.64867308077056, "彎35"],
[22.584799896698450, 120.64800683736249, "彎36"],
[22.582703739665064, 120.64590316103639, "急彎01下3","急彎",,"急彎"],
[22.582013920160640, 120.64631005909258, "彎rr4"],
[22.581563757468540, 120.64774690725149, "急彎02","急彎",,"急彎"],
[22.583453916074210, 120.64720794662499, "急彎03","急彎",,"急彎"],
[22.580992567577628, 120.64849052598437, "急彎04","急彎",,"急彎"],
[22.583050936022870, 120.64777911612705, "急彎05下2","急彎",,"急彎"],
[22.582121362084570, 120.64892086114091, "彎05"],
[22.578387605651340, 120.64971247385891, "坑洞03","坑洞",,"坑洞"],
[22.576843364475950, 120.65081693697746, "彎52"],
[22.575596110151270, 120.64970591597994, "彎53"],
[22.571896220921186, 120.65036759528631, "逍遙山莊下3","急彎",,"急彎"],

[22.575496845536147, 120.65052426650247, "彎54"],
[22.577265781774866, 120.65191606858853, "彎55"],
[22.578508767064537, 120.65131389357563, "坑洞04上2","坑洞",,"坑洞"],
[22.579779952998620, 120.65262972367259, "彎56"],
[22.582402181267586, 120.65114947459824, "彎57通信站"],
[22.585255717322900, 120.65335369071546, "拉拔克"],
[22.585703618189058, 120.65536279400534, "普查卡朗水溝蓋下2","坑洞",,"坑洞"],
[22.587315577042794, 120.65691765712258, "水槽"],
[22.587039118932154, 120.65992939675222, "急彎06水溝蓋上2","急彎",,"急彎"],
[22.590629698135977, 120.65974713603376, "急彎07上2下3","急彎",,"急彎"],
[22.590471544673793, 120.66264498498556, "急彎08","急彎",,"急彎"],
[22.589241098795250, 120.66460999148127, "牌樓","路口",,"路口"],
],[

[22.589241098795250, 120.66460999148127, "屏120-1_牌樓","路口",,"路口"],
[22.591972456879450, 120.66734298671749, "急彎","急彎"],
[22.593386038796442, 120.67046156816451, "返璞","坑洞",,"坑洞"],
[22.593693023559450, 120.67555271352622, "掉柏油A","坑洞"],
[22.592239613304425, 120.67722900831896, "掉柏油B",,,"坑洞"],
[22.591761685364610, 120.67935691835952, "貨櫃屋","坑洞"],
[22.592039093947136, 120.68094511596790, "坑洞041","坑洞",,"坑洞"],
[22.591389196902934, 120.68206019691863, "坑洞042(往上增坑洞)","坑洞",,"坑洞"],
[22.591747368731195, 120.68422205249813, "坑洞043","坑洞",,"坑洞"],
[22.591599051656083, 120.68486212232875, "坑洞05","坑洞",,"坑洞"],
[22.592177531280022, 120.68483357628378, "坑洞06-1","坑洞"],
// [22.592630575345552, 120.68464827381979, "坑洞06-2(上移)",,,"坑洞"],
[22.592884362411525, 120.68475106876217, "坑洞06-2(已上移)",,,"坑洞"],
[22.595115994968776, 120.68506473873026, "觀自在"],
[22.598383562209477, 120.68455114752990, "彎A3"],
[22.602304117175020, 120.68708932579440, "坑洞77","坑洞",,"坑洞"],
[22.606500530430420, 120.69437563854535, "坑洞","坑洞",,"坑洞"],
[22.606633881440352, 120.69482779987918, "空地","急彎",,"急彎"],
[22.606928277949660, 120.69154676474011, "彎A1"],
[22.607947926654507, 120.69152518862300, "彎A2"],
[22.610869623490217, 120.69874924464474, "坑洞07","坑洞",,"坑洞"],
[22.6145008,120.7017865,"停車場"],
[22.615443681182708, 120.70262923538111, "泰武斷崖"]
],[

[22.61266847075377,120.69993809532149, "日湯真_入口1"],
[22.61357005644286,120.70124190704566,"彎01"],
[22.613809573789847,120.70133024558362,"電桿"],
[22.613880067927372,120.70167639421153,"電桿收費亭"],
[22.61501512803279,120.70223332448214,"日湯真_入口3","路口"],
[22.614909280440436,120.70194080706936,"E08"],
[22.615160672882556,120.70174126247534,"救難繩"],
[22.61540915743708,120.70172476794434,"E07"],
[22.61570576407822,120.70167493755383,"E06"],
[22.61576723763887,120.70151823055944,"E05"],
[22.616016029163088,120.70162956707567,"E04"],
[22.616179755198644,120.70150875292673,"E03"],
[22.616384790371246,120.70106309651935,"E02"],
// [22.621937370512125,120.70367581710855,"休息站01b"],	//重畳點

[22.6163691735652,	120.700999845211,	"水泥底","路口"],
[22.6163599015386,	120.700640624632,	"電桿18"],
[22.6163139842759,	120.700408969164,	"電桿20"],
[22.6165242219495,	120.700230368284,	"電桿22"],
[22.6168926850124,	120.700365595732,	"電桿24"],
[22.6173427212350,	120.700532676865,	"電桿26"],
[22.6175306226832,	120.700784751881,	"電桿32"],
[22.6177846242491,	120.701007056851,	"電桿34"],
[22.6180688920823,	120.701179999221,	"電桿36"],
[22.6183848716357,	120.701237388141,	"電桿42"],
[22.6188872098394,	120.701461162056,	"電桿44"],
[22.6191211966622,	120.701622924144,	"電桿46"],
[22.6193633254871,	120.701665216964,	"電桿52"],
[22.6195273234284,	120.701946590632,	"電桿54"],

[22.6194132160070,	120.701433175848,	"水泥頂","路口"],		
[22.619745623676106,120.70154845769152,"點24"],
[22.61987573054951,120.70177984453117,"點25"],
[22.6202190084102,	120.701741953508,	"B01"],
[22.6206172736401,	120.702108474635,	"B02"],
[22.6206737396570,	120.702341293050,	"樹B03"],
[22.6211535013205,	120.702602887586,	"B04"],
[22.6214454128277,	120.702640901423,	"B05"],
[22.6216204740692,	120.702798114376,	"B06"],
[22.621708490361264,120.70315987192542,"B07"],

[22.621937370512125,120.70367581710855,"休息站01","休息站"],
[22.6221769833546,	120.703645237693,	"C01"],
[22.6226394404452,	120.703860792467,	"C02"],
[22.6228473625901,	120.704099273117,	"C03"],
[22.6230425369283,	120.704076825332,	"C04"],
[22.6232628506884,	120.704002788845,	"C05"],
[22.6235184076915,	120.703853850915,	"C06"],
[22.6237369575310,	120.703684671313,	"C07"],
[22.6238777627434,	120.703629586829,	"C08"],
[22.6240410955140,	120.703696069814,	"C09"],
[22.6247050301199,	120.703853009565,	"C10"],
[22.6251278814186,	120.704044702069,	"C11"],
[22.6252901277213,	120.704070781605,	"C12"],
[22.6256216551517,	120.704193654023,	"C13"],
[22.6258371071047,	120.704204951326,	"C14"],
[22.6260677994086,	120.704318429458,	"C15"],
[22.6261891033439,	120.704325080919,	"C16"],

[22.626309106974965,120.70441736305555,"c18"],
// [22.6291667, 120.7019444, "日湯真山"],
[22.6264667292546,	120.704335983466,	"休息站02","休息站"],
[22.6270069700570,	120.705182360752,	"D01"],
[22.6273599984907,	120.705660362859,	"日湯真東出口","路口"],
[22.6279503741011,	120.707077196570,	"D02"],
[22.6279873855995,	120.707469745347,	"D03"],
[22.6276710637854,	120.708156227535,	"D04"],
[22.6275271373037,	120.708763112585,	"D05"],
[22.6273095738636,	120.709696223156,	"D06"],
[22.6271271120597,	120.709918080051,	"D07"],

[22.626969353569677,120.70990233858107,"D077"],
[22.62649242983123,120.71049755059374,"崖頂","路口"],
[22.6260935020491,	120.710756250407,	"D08"],

[22.6257619269880,	120.711055255301,	"D09"],

[22.625096216539994,120.71220141454029,"宿舍叉路","路口"],
[22.6254285274398,	120.713181571455,	"D10"],

[22.625370031788954,120.71345147109773,"宿舍旁","路口"],
[22.625661341147897,120.71285853995774,"D11"],
[22.6265502903681,	120.712467629824,	"D12"],
[22.6268324101664,	120.712076236941,	"D13"],
[22.6273234303960,	120.711968861691,	"D14"],
[22.6278737630738,	120.712140825887,	"D15"],

[22.6282578294187,120.71216937843494,"水源橋","休息站"],
[22.625370031788954,120.71345147109773,"宿舍旁重覆","路口"],
// [22.627910793033372,120.71205956643135,"廁所路口","路口"],
[22.62494365285559,120.71328892315739,"D16"],
[22.62508807796253,120.7139035355051,"廁所路口","路口","rep,rcd"],
[22.6243669, 120.7148054, "管制站"],
[22.624396684841113,120.71457908355855,"管制站路口","路口"],
// [22.6243669, 120.7148054, "管制站"],
[22.6242538200133,	120.713870062414,	"電桿90"],
[22.6239711505707,	120.713466179863,	"電桿89"],
[22.6240261172705,	120.713102429752,	"電桿88"],
[22.6238358411943,	120.712913294485,	"電桿87"],
[22.6239522638566,	120.712515969875,	"電桿86"],
[22.6243490446910,	120.711944596435,	"電桿85"],
[22.6240471334875,	120.711264514548,	"電桿84"],
[22.6249466769935,120.71043541807936,"彎3"],
[22.6249412959056,	120.708987779579,	"F01"],
[22.6248504560714,	120.708090057874,	"F02"],
[22.62481669104701,120.70775806740215,"F03"],
[22.6244660704494,	120.707741331219,	"F04"],
[22.624293880894708,120.70710960104269,"F05"],
[22.62390407570037,120.70669008487421,"F06"],
[22.6234435703599,	120.706021193544,	"F07"],
[22.623103262991766,120.70580460932997,"F08"],
[22.6227022495096,	120.705538375205,	"F09"],
[22.6225244518828,	120.705338047518,	"F10"],
[22.6224301712491,	120.705067590307,	"F11"],
[22.6222412927974,	120.704252010956,	"F12"],
[22.6220403987036,	120.703897194391,	"F13"],
[22.621937370512125,120.70367581710855,"休息站01重覆"],
[22.6163691735652,	120.700999845211,	"水泥底重覆"],

[22.6161746477652,	120.700769524142,	"電桿14"],
[22.616129060822008,120.70069036396335,"A07"],
[22.61592530608093,120.70049382995761,"彎9"],
[22.6160598922900,	120.700949171502,	"電桿12"],
[22.6160748747056,	120.701189618323,	 "彎8"],
[22.615759048449434,120.70090405496053,"A052"],
[22.615323498258697,120.70034446042034,"A051"],
[22.6149756566865,	120.700046136645,	"彎7"],
[22.615022270899125,120.70047510766796,"A10"],
[22.615125322335576,120.70104832010698,"A09"],
[22.615186330141523,120.70158159332216,"彎6"],
[22.6149245022011,	120.701353061484,	"A08"],
[22.6148367720409,	120.701366934857,	"A07"],
[22.6148564063131,	120.701439223749,	"A06"],
[22.614681305904572,120.7013041857417,"A05"],
[22.61452300059348,120.70092629107046,"A04"],
[22.6139824998672,	120.700708728201,	"彎02"],
[22.614073233966618,120.7008885916784,"A03"],				
[22.614099298420065,120.70150967046278,"A02"],
// [22.614169094597326,120.70184175201281,"A01"],
],[

[22.935834086603325, 120.17631556177510, "台86_西起點"],
[22.935901191445396, 120.18032485219945, "彎07"],
[22.931875811710180, 120.19967014322756, "彎裡2K東出",,,"交流道"],
[22.927658345240154, 120.20405023362777, "彎06"],
[22.927491773722800, 120.21557065562621, "彎05"],
[22.931285422971296, 120.22366999134361, "湖內5K西出(台1)",,"s","交流道"],//結束點

[22.943750221588270, 120.24336752221714, "彎46"],
[22.942623194631146, 120.24965817528305, "仁德系統(國1)"],
[22.940840418075833, 120.25425870332441, "彎04"],
[22.934595270792208, 120.26099575774114, "上崙交"],
[22.932268062232550, 120.26736769715247, "彎03"],
[22.932046937401660, 120.27425760749732, "匣道大潭東出","交流道","s"],//結束點
[22.932141687818145, 120.27792017759687, "大潭交11k"],
[22.938965748487330, 120.29819182101409, "彎02"],
[22.941493147303150, 120.30124755313828, "彎01"],
[22.971278480819183, 120.31327247513406, "測速70西路中",,,"測速"],
[22.975157067181804, 120.31877334375743, "台19甲","號誌",,"號誌"],
[22.976705195681916, 120.32280595255693, "同向匯合陸橋",,"s"],
[22.976989521530918, 120.32450692479333, "國道下方"],
[22.976691231456500, 120.32664732264880, "反向匯合"],
[22.975325461556306, 120.32744965428243, "反曲點"],
[22.973947774150542, 120.32848819487776, "匣道關廟北出"],//結束點
// [22.973940257514684, 120.32848339095966, "台86東_關廟交"]
],[

[22.976705195681916, 120.32280595255693, "匣道關廟_東往南"],
[22.976659929908863, 120.32366393797008, "彎1"],
[22.976447560215362, 120.32443104974865, "彎2"],
[22.975588200363244, 120.32562195055992, "彎4"],
[22.974717885023050, 120.32679886237133, "匯入點"]
],[

[22.932046937401660, 120.27425760749732, "匣道大潭_東出往南"],//結束點
[22.931909045465435, 120.27647470430121, "分叉點"],
[22.931455819712017, 120.27728009130608, "彎中"],
[22.930380705789826, 120.27751839978563, "匯入點"],
[22.930169089657756, 120.27771980549180, "匣道大潭北入往東",,"s"],
[22.928072232284517, 120.27730529866146, "彎3"],
[22.926935762645975, 120.27689745159343, "歸仁八路"],
[22.924487294176400, 120.27582517026713, "明德路"],
[22.923070312574980, 120.27522162864295, "歸仁十四路"],
[22.922189964938912, 120.27483259148335, "歸仁十六路"],
[22.920994395036594, 120.27433146584019, "大武路(山隆)"],//山隆加油站
[22.919042309398930, 120.27344986410958, "武東一街"],		
],[

[22.930169089657756, 120.27771980549180, "匣道大潭_北入往東"],
[22.930704517864626, 120.27793438220907, "彎5"],
[22.930843533572514, 120.27851971129486, "分叉點1"],
[22.931035873860730, 120.27941562023923, "彎7"],
[22.931492325633670, 120.27991513001813, "分叉點3"],
[22.932323924045264, 120.28065050571537, "彎9"],
[22.932935749640240, 120.28171031315097, "匯入點"],		
],[

[22.932529934213882, 120.22109146223270, "匣道湖內_西出往北"],
[22.931900026947790, 120.22131676780589, "彎2"],
[22.931431917493676, 120.22199939000438, "彎3"],
[22.931144134364573, 120.22287244903960, "彎4"],
[22.931285422971296, 120.22366999134361, "匯入點往北"],		
],[

[22.928916323210040, 120.22083320612182, "匣道湖內_南入往東"],
[22.928358655288620, 120.22078090304616, "彎1"],
[22.927977611762174, 120.22053883369176, "彎2"],
[22.927915236621995, 120.22001177963030, "彎3"],
[22.928260461022980, 120.21966242189559, "彎4"],
[22.928726111149130, 120.21975361700152, "彎5"],
[22.928981168172466, 120.22011035080620, "彎停止線"],
[22.931400239401040, 120.22422401668291, "匯入點"]
],[

[23.006205068737728, 120.20609455278554, "台1台南_西門路北"],
[23.006579986820590, 120.20727877001934, "70巷意面"],
[23.007701328798806, 120.20972211923088, "小北路", "路口",,"路口"],
[23.004520606021483, 120.21078829615375, "公園北路"],
[23.001008523186776, 120.20873029138920, "公園南路"],
[22.998063646178430, 120.20694725426088, "成功路"],
[22.995679245940316, 120.20574519188271, "民族路"],
[22.994264943615800, 120.20540844288773, "民權路"],
[22.993017795296343, 120.20517885560020, "圓環北", "號誌",,"號誌"],
//公園路
[22.992261192219853, 120.20538560345075, "圓環東南", "號誌",,"號誌"],
[22.988965418139585, 120.20765635885944, "府前路R80",,"s"],
[22.986220791966865, 120.20990895288840, "樹林街"],
[22.984583845185580, 120.21116379385018, "府連路R110"], 
[22.982520880136445, 120.21136638747849, "五妃街"],
[22.981254574359404, 120.21202626011987, "林森路","號誌"],
[22.980930085884780, 120.21220250902789, "林森路(南下靠左)",,, "號誌"],
// [22.9807394351853, 120.2123072481083, "大同路100巷", "路口"]
[22.976294148893480, 120.21394046244464, "大林路(停中華路)"],
[22.972416153855065, 120.21481356468252, "中華路",,"s"],

[22.967393277491430, 120.21589322797092, "國民路"],
[22.964595069946935, 120.21645445767052, "生產路G60","號誌",,"號誌"],
[22.960437309262627, 120.21697996600106, "保仁路二空"],
[22.952419382785543, 120.21798832077249, "亞航街G60雙號誌",,, "號誌"],
[22.944055361810320, 120.22033245507691, "文賢路口G60R40","號誌",,"號誌"],
[22.941787731378756, 120.22095711150357, "彎02"],
[22.939924714082440, 120.22100679026250, "測速70南路中","測速"],		
[22.937275501642834, 120.22099726418344, "文華路R40"],
[22.931863465339756, 120.22095929484148, "測速70南路中","測速"],
[22.929629923219980, 120.22092520566011, "高架下"],
[22.928916323210040, 120.22083320612182, "86匣道東向入口","交流道","s"],
[22.922997607021347, 120.22386310277575, "台1台南_保安路"]
],[

[22.736630751985990, 120.33403045596671, "楠梓興西路_台22"],
[22.730374901857270, 120.33386954531063, "興南路"],
[22.725100451120653, 120.33307316463575, "楠陽路"],
[22.723001377792222, 120.33252209423672, "經建路"],
[22.721350269294420, 120.33205487578753, "鳯楠路", "路口"],
[22.720714405445317, 120.33270586489223, "興西路",,,"路口"],

[22.717362160616510, 120.33489862033673, "33巷"],
[22.715247527695304, 120.33636801625340, "369巷"],
[22.714002452851968, 120.33722870005444, "329巷"],
[22.712882218436510, 120.33793893467126, "竹楠路"],
[22.709515050654215, 120.34005760080285, "後庄巷"],
[22.708547635243320, 120.34063221488138, "竹門巷"],
[22.705893429216697, 120.34229473714870, "高鐵下","號誌",,"號誌"],

[22.703238189360370, 120.34393112860070, "仁信巷"],
[22.702093881653620, 120.34461045445504, "工業一路"],
[22.701061433460087, 120.34526960734088, "工業二路"],
[22.698785605631024, 120.34673099709201, "通法寺"],
[22.697627181857484, 120.34734787563002, "中華路"],
[22.696649552816083, 120.34781010891841, "八德一路"],
[22.695054699796850, 120.34856583346150, "文南二街"],
[22.694100233852982, 120.34900501024516, "165巷"],
[22.693105988562170, 120.34946954110053, "新庄路"],
[22.687821959973167, 120.35195922749112, "名山二街"],
[22.687373406125644, 120.35220825173393, "彎內四巷"],
[22.685831276384660, 120.35308910427976, "國10下","號誌",,"號誌"],

[22.684433009108050, 120.35379193222151, "86巷"],
[22.681695099700250, 120.35525775456180, "仁心路"],
[22.678481022649738, 120.35709548378601, "南勢巷"],
[22.676171911346724, 120.35839896631121, "仁勇路"],
[22.671352882306586, 120.36101772485478, "新生路"],
[22.669429834212902, 120.36203923990561, "400巷"],
[22.667879944606803, 120.36261760574801, "東山路"],
[22.666893626161315, 120.36280701825228, "322巷"],
[22.665179843684758, 120.36310387765907, "夢裡路"],
[22.662585364196925, 120.36355126716653, "松埔路"],
[22.661317259026365, 120.36377586494119, "大仁東路"],
[22.659092975647592, 120.36417798317320, "神農路口", "路口",,"路口"],
[22.659311496803570, 120.36561418325180, "48巷"],
[22.659520030911900, 120.37257845629937, "水管路","號誌",,"號誌"],
[22.659565997004950, 120.37549773153953, "大榮巷"],
[22.659446128231913, 120.37976755535666, "松埔路","號誌"],
[22.658517071332060, 120.38158730665273, "大同路",,,"號誌"],
[22.656428350452533, 120.38491553053193, "同富街"],
[22.655055086153130, 120.38607293182085, "131巷"],
[22.651293022031030, 120.38871064812523, "美德一街"],
[22.649735877004684, 120.39160124222946, "美山路","號誌",,"號誌"],
[22.646597139082534, 120.39923267822817, "彎3"],
[22.645381868139904, 120.40000245536821, "瓦厝街","號誌"],
[22.642606629227530, 120.40067132197753, "民權街", "路口",,"路口"],
[22.642718952138992, 120.40485075086903, "江山路北", "路口",,"路口"],
[22.640184057263603, 120.40523343929571, "鳯屏二路_江山路口", "路口",,"路口"]
],[																						

// [22.656615104497494, 120.30881782253226, "大順自由路","號誌",,"號誌"],//非台一
[22.654436186505425, 120.30357054179292, "高雄大順路_博愛龍德路口"],
[22.654816611256848, 120.30755265901110, "好市多後門"],
[22.655265993448070, 120.30870647566398, "自由路"],
[22.655279527232622, 120.31061237140867, "彎56"],
[22.656295486293576, 120.31081243753817, "龍德新路(自由禁左轉)", "路口",,"路口"],
[22.655970054978898, 120.31276989627523, "河堤路"],
[22.655816867893755, 120.31370994834083, "聯興路"],
[22.655493701401024, 120.31541457156159, "民族路"],
[22.653538680040300, 120.31889856211865, "鼎山街"],
[22.652244964959767, 120.32074796491561, "莊敬路"],
[22.651100982629902, 120.32232052741827, "彎中街"],
[22.649777978147927, 120.32414352266113, "建功路"],	
[22.646611378826005, 120.32549025361911, "大豐路"],
[22.643779023606510, 120.32635778478975, "建興路"],
[22.641496602809820, 120.32718990342501, "覺民路","路口","s"],//(大順禁左轉)
// [22.640746998803735, 120.33030677899511, "臥龍路", "路口"],
[22.639148060257018, 120.32797290769224, "九如",,,"號誌"],
[22.637098539461075, 120.32721159839427, "鐵道一街a"],
[22.636764885114392, 120.32708137621694, "鐵道一街b"],
],[

[22.64149660280982, 120.32718990342501, "匣道高雄_覺民路","路口"],
[22.640746998803735, 120.33030677899511, "臥龍路", "路口"],
// [22.639148060257018, 120.32797290769224, "大順路",,,"號誌"],
[22.638814888950794, 120.32989061927688, "九如臥龍"],
],[

[22.639812178271423, 120.32082192745133, "台1高雄_平等路"],
[22.639148060257018, 120.32797290769224, "大順",,"s","號誌"],
[22.639052144842342, 120.32846016634653, "測速50西路中",,,"測速"],
[22.638814888950794, 120.32989061927688, "臥龍"],
[22.638475881063112, 120.33162334330774, "測速50東","測速"],
[22.638445130915205, 120.33209811473476, "大昌路"],
[22.638214081719493, 120.33381480619173, "測速50西",,,"測速"],
[22.637956726623380, 120.33485694575069, "光武路"],
[22.637542349782386, 120.33716403727107, "國道下"],
[22.637317334860622, 120.33829969563959, "水源路"],
[22.636879795698224, 120.34090154771307, "陽明路"],
[22.636404418784380, 120.34344542908131, "正義路"],
[22.636279400935546, 120.34443647973721, "澄清路"],
[22.636521553815940, 120.34484650555163, "測速50西路中",,,"測速"],
[22.637476150280900, 120.34640971532583, "文安南街"],
[22.637844556798220, 120.34814590687785, "文濱路"],
[22.637494857805210, 120.35057209888800, "青年路"],
[22.636348761606870, 120.35721342010389, "文衡路"],
[22.635984214072568, 120.35936095656072, "文英路"],
[22.635501326890605, 120.36200922935758, "鳳松路"],

[22.635229112419380, 120.36336004158221, "測速70東路越線", "測速"],
[22.635179892001620, 120.36385197061206, "鳳林路"],
[22.634132120590940, 120.37012392539445, "彎瑞光街"],
[22.635421093866388, 120.37318949926723, "彎2"],
[22.636353697407170, 120.38229941534014, "彎_民貴街"],
[22.633858111068360, 120.38797010236682, "彎6"],

[22.634057297985520, 120.38919031335351, "賓士路口","路口",,"路口"],
[22.636104199865386, 120.39206782215768, "八德路","號誌",,"號誌"],
[22.637413160019330, 120.39446380128109, "仁愛路"],
[22.638708945666620, 120.39817396166862, "忠孝路慈惠醫"],
[22.639381319933790, 120.40146185845819, "光明路","號誌",,"號誌"],
[22.639462373584585, 120.40179687981139, "測速70西路中",,,"測速"],
[22.640180923240170, 120.40530035412054, "光明小路",,,"路口"],
[22.640889767906486, 120.40878193206538, "測速70東路中越線a","測速"],
[22.640931082898454, 120.40904031784287, "江山路萊爾富"],
[22.641547556176167, 120.41327831091964, "測速70東b路中","測速"],
[22.641582106154587, 120.41377438416654, "180巷"],
[22.642159446314253, 120.41850877227230, "磚仔窰台29"],
[22.644811662781876, 120.42788668062792, "高屏橋西"],
[22.645491736876888, 120.43222887169172, "彎2"],
[22.647578178236383, 120.43998367376734, "彎3"],
[22.649060457408485, 120.44409079444500, "高屏橋東"]

],[

[22.644811662781876, 120.42788668062792, "台1屏東北段_高屏橋西"],
[22.646530631848517, 120.43241461668282, "彎3"],
[22.648396087508000, 120.43954249821527, "彎5"],
[22.649060457408485, 120.44409079444500, "高屏橋東"],
[22.652129610229185, 120.45507473212501, "測速70東(路中)","測速",,"測速"],
[22.654545853790143, 120.46379049366499, "450巷"],
[22.655823532381984, 120.46656980548235, "建國路口G30R90","路口",,"路口"],
[22.655681558333953, 120.46721365458004, "和生建國東匣道口",,"s"],
[22.654833663178100, 120.47077155394280, "542巷"],
[22.654252101407710, 120.47318992350883, "山隆巷"],
[22.653656922272166, 120.47563281122031, "武成街"],
[22.652964329384100, 120.47843662479580, "建南路G60R90","號誌",,"號誌"],

[22.651762313125314, 120.48597167701199, "復興路G50R90","號誌",,"號誌"],
[22.652201130743588, 120.49081962650784, "頂宅街"],
[22.652838739424972, 120.49458501291548, "彎567巷"],//中油彎道
[22.654675275202116, 120.49763292197711, "測速60東路中越線","測速"],
[22.654892831843018, 120.49793962803176, "工業六路","號誌",,"號誌"],
[22.657599206003407, 120.50209948590671, "工業路","號誌",,"號誌"],
[22.659860060390763, 120.50601741683295, "歸仁路R50","號誌",,"號誌"],

[22.659911101873785, 120.51121459162805, "民生路",,"s"],
[22.659473739849265, 120.51209523720857, "安心巷(速限50北路中)",,"s","測速"],
// [22.659300082190747, 120.51238397264552, "測速50北路中",,,"測速"],//太近
[22.658034247616996, 120.51463021734180, "瑞光路口",,"s"],
[22.655539129939942, 120.51901611238941, "果菜市場g110r40","號誌",,"號誌"],
[22.654982563036120, 120.51998037437072, "棕櫚泉"],
[22.653811279377150, 120.52202226441172, "永達巷2"],
[22.652766556564803, 120.52386838391126, "永達巷2"],
[22.652427270814417, 120.52446484023852, "永達巷"],
[22.651955098169168, 120.52522991741225, "中華路g110r40",,"s"],
// [22.651641965385940, 120.52577244459546, "測速60南路中越線","測速"],//太近
[22.651515374460395, 120.52598179763177, "民權路(速限60南路中)"],
[22.650677214478804, 120.52685860645906, "民族路g110r40"],
[22.649322449799737, 120.52806492385191, "大同街g110r40"],
[22.642845880502730, 120.53384886704120, "長安巷g90r40紅燈衝不過"],	
//[22.640091466178593, 120.5362835094121, "信義路g90r40", ,"s"],
[22.640102558207854, 120.53631229041912, "信義路g90r45", ,"s"],//220706座標重取
[22.637586406499317, 120.53851589333695, "永豐路"],
],[

[22.633360853308417, 120.53364818589786, "麟洛永豐路_屏監"],
[22.635439408093620, 120.53604730633950, "匣道南下",,"s"],
[22.635816117406613, 120.53645008598258, "國道下"],
[22.637586406499317, 120.53851589333695, "台1"],
[22.639868959976262, 120.53863935177274, "彎37"],
[22.644163253922270, 120.54115889357361, "信義路"],
[22.649376978343510, 120.54472631870603, "匯入點"],
],[

[22.651955098169168, 120.52522991741225, "麟洛中華路_台1"],	//往徐板家
[22.650412079083720, 120.52456620498937, "三叉口"],
[22.649662434593770, 120.52400175269760, "復興街"],
[22.648994598265475, 120.52540707198378, "814"],
],[

[22.644810413273188, 120.52377325155706, "麟洛中正路_徐板家"],
[22.648994598265475, 120.52540707198378, "814"],	//同上
[22.649846467275026, 120.52560405305977, "大同街"],
[22.648032070621460, 120.52919971595182, "大同街國光"],
],[

[22.572203860561462, 120.54403456039634, "潮州路_台1"],
[22.572163429410220, 120.54370673553038, "彎5"],
[22.569594220866627, 120.54077678319364, "速限60南路中","測速"],
[22.569429521118380, 120.54057809384372, "屏83右1","號誌","s","號誌"],
[22.568919977549610, 120.54004637062756, "88末端"],
[22.567708040842806, 120.53948561593468, "彎8"],
[22.562950900239500, 120.53977473613809, "堤防路口"],
],[

[22.569255130438595, 120.53953109619614, "匣道88潮州_西入匯入點"],
[22.569168442570433, 120.53997567234116, "彎2"],
[22.569429521118380, 120.54057809384372, "西入屏83"],
],[
												//台1屏東中段
[22.633538679437965, 120.54216382730912, "台1內埔_人和路", "號誌",,"號誌"],
[22.630497495706020, 120.54519714705100, "新東路", "號誌",,"號誌"],
[22.626082765726760, 120.55197096207752, "測速05","測速"],
[22.622862605834474, 120.55660160740435, "南寧路", "號誌",,"號誌"],
[22.616662718550568, 120.55775531281208, "自強路", "號誌",,"號誌"],
[22.608652841719344, 120.55968243022917, "測速08","測速"],
[22.608311309619182, 120.55979579548797, "復興路", "號誌",,"號誌"],
[22.602662517383028, 120.56114394122493, "學人路", "號誌",,"號誌"],
[22.599571823220582, 120.55972752051989, "測速11",,,"測速"],
[22.595190579268400, 120.55740095893346, "四維路內埔", "號誌",,"號誌"],
[22.582267818066565, 120.54870891715380, "測速16","測速"],
[22.578510182409005, 120.54630453429209, "公正路", "號誌",,"號誌"],
[22.572203860561462, 120.54403456039634, "潮州路屏85(左1)", "號誌","s","號誌"],//接88

[22.567990075120120, 120.54397646040196, "彎東港溪"],
[22.564878446277607, 120.54738283960205, "彎頭溝水橋"],
[22.561758424990120, 120.55350227707396, "四維路(山隆)", "號誌",,"號誌"],
[22.559397805079430, 120.55600847239336, "彎s2"],
[22.552586814538408, 120.55571920568550, "速限70_南向路中415k","測速"],
[22.550797510648323, 120.55559716493131, "三林路", "號誌",,"號誌"],

[22.543384550527346, 120.55496971381483, "三星路"],
[22.542095958863367, 120.55440286502957, "彎三星"],
[22.540933593954566, 120.55273118657391, "吉星路"],

[22.539989581824372, 120.54997334105612, "三城路", "號誌",,"號誌"],
[22.539552101905297, 120.54875264383196, "光華路(金弘)", "路口","s"],
[22.536464658255557, 120.54002527701802, "光春路"]
],[
																					
[22.990428066601076, 120.19780965665197, "南市_西門路"],
[22.989942829042207, 120.20035038209184, "永福府前"],
[22.989535159951803, 120.20224115934423, "忠義路"],
[22.989037095980850, 120.20460864379818, "南門路"],
[22.988964914094694, 120.20765672145865, "南市_開山路"],
],[
//中華路
[22.972412714723220, 120.21481029506266, "南市_大同路(右轉停紅燈)"],
[22.973769927618390, 120.22148160077008, "377巷R50G60(停紅燈)"],
[22.974005400632098, 120.22243069197685, "357巷"],
[22.974333221265518, 120.22312136080892, "崇明路G60R70"],
],[

[22.989942829042207, 120.20035038209184, "南市_永福x府前","路口","s","路口"],
[22.992251798658174, 120.20084298579434, "永福路","路口",,"路口"],
[22.992738588587297, 120.19861833612510, "中正路","路口",,"路口"],
[22.990429445535817, 120.19780969700320, "府前路"],
[22.987401089922763, 120.19753782949647, "永華路"],
[22.986333154748692, 120.19755594081165, "樹林街"],
[22.985096514387870, 120.19757565593272, "西門路","路口",,"路口"],
[22.985122671604636, 120.19637689433320, "南寧街","路口",,"路口"],
																					//陳家伏苓糕
[22.983843349737928, 120.19645067939489, "國華街","路口",,"路口"],
[22.983868041971245, 120.19566450015733, "115巷"],
[22.983849522359010, 120.19501272336689, "府緯街","路口",,"路口"],
[22.981469740961604, 120.19509075977518, "建康路","號誌",,"號誌"],
[22.978259966041534, 120.19517997846175, "新興路","號誌",,"號誌"],
[22.974932788715150, 120.19537816526025, "大成路","號誌",,"號誌"],
[22.967216509000707, 120.19540367809161, "新都路","號誌",,"號誌"],
[22.962317167683130, 120.19546142030968, "中華路","號誌",,"號誌"],
[22.961165429105247, 120.19547765516063, "863巷"],
[22.960221204341090, 120.19546926409944, "827巷"],
[22.958810383078090, 120.19547078885118, "興隆路","號誌",,"號誌"],
[22.956636175775763, 120.19547730101853, "699巷"],
[22.954067826937750, 120.19549118629797, "730巷"],
[22.950640762528238, 120.19551016636548, "503巷"],
[22.949008290285736, 120.19551705096191, "490巷"],
[22.939112552931490, 120.19556448857217, "萬年路","號誌",,"號誌"],
[22.932626829740283, 120.19559510868507, "台南永成路南_台86"],
],[

[23.342896729384670, 120.43877249044634, "匣道白河_北出往東"],
[23.346187357048496, 120.43988888900094, "分叉點"],
[23.347011085910495, 120.44031492890655, "彎2"],
[23.347172440898476, 120.44081308201670, "匯入點"],
],[

[23.347171613718718, 120.43826373895928, "匣道白河_東向南入"],
[23.346967453283472, 120.43870402503998, "彎2"],
[23.346486951337752, 120.43890755709774, "分叉點"],
[23.343767169095270, 120.43877780259220, "匯入點"],
],[
																				
[23.34664154892772, 120.40923291021235, "南172西白河_彎93"],																				
[23.34540737783434, 120.4123478885672, "中山路南165","路口",,"路口"],
[23.344650009974295, 120.41603214230916, "彎91"],
[23.345091472969475, 120.4172830892249, "康樂路", "路口",,"路口"],
[23.346798161978036, 120.42053218813966, "彎90"],
[23.345270162868264, 120.42735830113021, "東河西", "號誌",,"號誌"],
[23.34726304858996, 120.43948357733692, "白河交"],

[23.34736177842498, 120.4447239149028,"東河東", "號誌",,"號誌"],
[23.35037578490617, 120.45197534909033, "虎子墓01", "號誌",,"號誌"],
[23.352307148834168, 120.46367140205685,"車道縮減虎子墓02", "號誌",,"號誌"],
[23.352295278291262, 120.46795001308695, "南98白河水庫", "號誌",,"號誌"],
[23.351997788342075, 120.4710576188271, "急彎2","急彎",,"急彎"],
[23.345975279208922, 120.47300827746007, "仙大路外環", "號誌",,"號誌"],

[23.344536783584005, 120.47493729997255, "南172乙仙草", "號誌",,"號誌"],
[23.34257588640918, 120.480608065676,  "彎61"],
[23.343267603371697, 120.48206935416853,  "彎62"],
[23.341452572333285, 120.48434695450898,  "彎63"],
[23.342352466844307, 120.48837449885654,  "彎64"],
[23.34175221877526, 120.49224394793497,  "彎65"],
[23.340894062780535, 120.49325621658606,  "彎66"],
[23.34166239670377, 120.49533245821988,  "彎67"],
[23.340442014099377, 120.49721221372484,  "彎68"],

[23.340355027385485, 120.49928365378014, "捷徑下", "路口"],
[23.340394208290128, 120.50096360483901,  "急彎A1","急彎"],
[23.338389361000225, 120.49915942867383,  "彎14"],
[23.33666093421136, 120.4994215213416,  "彎16"],
[23.3347303873146, 120.49986473073986,  "彎18"],
[23.333887787226683, 120.49957368556672,  "彎20"],
[23.33292378360401, 120.50166878798557,"彎22"],
[23.334149222954125, 120.50311720366186, "捷徑上", "路口"],

[23.33385015664403, 120.5033061215673, "頂關子嶺"],
[23.333973582855815, 120.50394838922603, "巷44"],
[23.33248334024646, 120.50568363045694, "巷46"],
[23.33209976078922, 120.50493159843747, "巷48"],
[23.331817146116613, 120.50516293896632, "巷50"],
[23.331903346734066, 120.50528028561139, "景大"],

[23.33385015664403, 120.5033061215673, "頂關子嶺(重覆)"],
[23.33638531525768, 120.50398936957284, "彎33"],
[23.337974916520405, 120.50308434242429, "彎34"],
[23.339344792930895, 120.50313343078629, "彎35"],

[23.337751346472697, 120.50537706769376, "彎37"],
[23.342090346811354, 120.50372659572749, "南175", "路口",,"路口"],
[23.341476178144084, 120.5024458216987, "彎77"],
[23.340419604980966, 120.50247185780395, "同翠橋"],
[23.340355027385485, 120.49928365378014, "捷徑下重覆"]		
]];	
	
	var taskID = 2;
	// var DEBUG = true;
		var DEBUG = false;
	var points = [];
	//var mapPoints = [];
	var taskTitle = "";
	var zoom = -1;
	
	var nextPoint = 0;	//下一個點
	var Point01 = [22.659517486714293,120.51431010230766, "田中巷"];	
	var Point02 = [22.66613321392555, 120.50085349955407,"一樓"];
	var Point03 = [22.6243669, 120.7148054, "管制站"];
	var Point04 = [22.64271533068867, 120.53940675958226, "種苗中心"];
	
	var recentPoint = Point04;
	var edgeVector = -1;
	var coords_heading = -1;	//最近一次的GPS方向
	var coords_speed = -1;
	//上一個通過的點
	var passPoint = [0,0];
		passPoint[0] = recentPoint[0];
		passPoint[1] = recentPoint[1];
		
	var zoom0 = -1;
	var zoom1 = -1;
	
	var centerCoords0 = [23,120.5];
	var centerCoords = [23,120.5];
	
	var nextDist = 0;
	var shadowDist = -1;
	var preDist = 0;
	var incDistCnt = 0;
// var heading = -1;	//目標的方向0~360(以前一目標計算,但初值以移動點計算)
	var pathAngle = -1;
	// 尋標,新任務或去回程切換時要開啟, 有GPS的狀態時依據當前座標找到最近點
	var searchPoint=true;
	
	var receGap = 0;
	var prevGap = 0;
	//路徑的順逆向,逆向為-1(路徑數據以向南及向東為順向)
	var vector = 1;	
	/** 一般提醒*/
	var enAlarm = true;
	/** 高速提醒*/
	var enAlarmHigh = true;
	
	var canvas = document.getElementById("canvas");
	//canvas.addEventListener("click", click, false);

    canvas.addEventListener('mousedown',mouseDown);
	canvas.addEventListener('mousemove',mouseMove);
	canvas.addEventListener('mouseup',mouseUp);
	
	canvas.addEventListener('touchstart',touchStart);
    canvas.addEventListener('touchmove',touchMove);
    canvas.addEventListener('touchend',touchEnd);

	var enGestures = false;
	
	var ctx = canvas.getContext("2d");

	canvas.width = 950;canvas.height = 950;		//寬高預設值為300×150
	// canvas.width = window.innerWidth;
	// canvas.height = canvas.width;
	var centerX = canvas.width  / 2;
	var centerY = canvas.height / 2;
	

	//var scrPoint = gps2scr(recentPoint);
	const voice = new Audio();
	//voice.volume = 0.5;//預設值為何?

	 var startGestX = -1;
	var startGestY = -1;

	var oldClickTimes = -1;
	var viewMode = 1;
	
	var ins = document.getElementById("insertCoord");

	class TODO {}// function TODO(){}
	var _todo = new TODO();
	_todo._500資料檔案化_匯出_匯入= function(){}	//
	class canvas01{}
	var myCanvas = new canvas01();
	
	class map01{}
	var myMap = new map01();
	
	class control01{}
	var myCtl = new control01();
	/**
		
	*/
	function test02(){
		strGPS = strGPS.substr(1,3)+strGPS.substr(0,1);
		console.log(strGPS.substr(0,1));
		
	p0=	[22.665588375791046, 120.50101392899106,""];
		// [22.66654286222146, 120.50113602621077,"民利35巷"],
		p1=[22.665285944517155, 120.50179304264677,"殺蛇橋"];
		p2 = [22.66608654077297, 120.50036725372237,"工業路"];
	angleOffset(p0,p1,p2);
	}

function getAzimuth(p0, p1){
	d1y = getDistance([p1[0],p0[1]],p0);
	if(p1[0] < p0[0]){
		d1y *= -1;
	}
	d1x = getDistance([p1[0],p0[1]],p1);
	if(p1[1] < p0[1]){
		d1x *= -1;
	}
	//geometric angle幾何角度
	ga = Math.atan2(d1y,d1x);
	ga = Math.PI/2 - ga;
	if(ga < 0){
		ga += Math.PI*2;
	}
	return ga * 180/Math.PI;	//轉方位角0~360
}

function angleOffset(p0,p1,p2){		
	a1 = getAzimuth(p0,p1);
	a2 = getAzimuth(p0,p2);
	dA = Math.abs(a1 - a2);

	if(dA > 180){
		dA = 360 - dA;
	}
	//(dA*180/Math.PI
	return dA;
}
	
	function test03(){
		p=[	[22.66654286222146, 120.50113602621077,"民利35巷"],
			[22.665285944517155, 120.50179304264677,"殺蛇橋"],
			[22.66608654077297, 120.50036725372237,"工業路"],
			[22.6684552313614, 120.5042532586352, "伊谷"],
			[22.668182980030384, 120.50013875013059,"泳池"]
			];
			a1 = getAzimuth(p[0], p[1]);
			if(true){

					d1 = Math.PI/2 - a1;
				if(d1 < 0){
					d1 += Math.PI*2;
				}
						
			}else{
				d1 = -a1 -(-Math.PI/2);
				
				if( d1 > Math.PI*2 ){
					d1 -= Math.PI*2;
				}
			}
			d1 *= 180/Math.PI;
console.log(a1, d1);
			
			
	}
	function test01(){
			p=[	[22.66654286222146, 120.50113602621077,"民利35巷"],
			[22.665285944517155, 120.50179304264677,"殺蛇橋"],
			[22.66608654077297, 120.50036725372237,"工業路"]];
	pp = [[,],[,],[,]];
	
	console.log(Math.atan(-1));
	pp[1][0] = p[0][0];
	pp[1][1] = p[1][1];
	// per1=	(p[1][1]-p[0][1]) / (p[1][0]-p[0][0]);
	per1=	getDistance( pp[1],p[0]) / -getDistance(pp[1],p[1]);
	
	an1 = Math.atan(per1);
		an1 = Math.atan2(-getDistance(pp[1],p[0]),getDistance( pp[1],p[1]))
	console.log(per1,an1);
	
	pp[2][0] = p[0][0];
	pp[2][1] = p[2][1];
	// per1=	(p[1][1]-p[0][1]) / (p[1][0]-p[0][0]);
	per2=	getDistance( pp[2],p[0]) / getDistance(pp[2],p[2]);
	an2 = Math.atan(per2);	

	console.log(per2,an2);
	// alert("stop!");

		
	}
	
function init(){
	// alert("abc".indexOf("a"));
// showMsg("init(s)");
	// nextDist = 3.234;
	// showMsg(Math.round(nextDist));
	// showMsg(nextDist.toFixed());
		//file://即使同意, 仍然禁止
	/*
	if ('Notification' in window) {
		Notification.requestPermission(function(status){
			console.log('User Choice', status);
			if (status !== 'granted') {
				console.log('推播允許被拒絕了!');
			} else {

			}
		});
	new Notification('訂閱成功！！！');
	}
	*/

	try{
		for(var t=0; t < tasks.length; t++){
			for(var i=1; i < tasks[t].length; i++){
				 strtmp = tasks[t][i-1][2];
				 strtmp1= strtmp;
			}
		}
	}catch{
		showMsg("data err after "+strtmp1 );
		//TODO tasks[1+][0]後面缺逗號, 執行時期才會發現
		// showMsg(e.message);
	}
	// alert(tasks.length);
	// return;

	startGPS();
	//保存最後任務編號
	 taskID = localStorage.taskID ? localStorage.taskID : taskID;
	if(taskID > tasks.length){
		taskID = 0;
	}
	initTask();
	// nearPoint();//	無GPS時測試用。
	newSpace();

	// startGPS();
	noSleep();	//note 9 上, chrome 92.0.4515.131有效, 三星16.2.1.56無效

	myCanvas.drawClearMap();
	myCanvas.drawBaseMap();
		nextDist = getDistance(recentPoint,  points[nextPoint]);
		newDist2 = Math.cos(2*Math.PI *150/360 - Math.atan((recentPoint[1]- points[nextPoint][1])/(recentPoint[0] - points[nextPoint][0])))*nextDist;

ins.innerHTML = localStorage.insertCoord;
	//console.log(nextDist + ", " + newDist2);
	// showData();
// showMsg("init(e)");
}

function insertCoord(coordType){
	//	新增點, 插入陣列內, 陣列滙出, 5種新增鈕
	//console.log("insertCoord()");
		//document.getElementById("watchStr").innerHTML= output;
	playVoice('當');
	strtmp =  recentPoint[0]+','+recentPoint[1] + ',"自訂點","'+
	coordType +	'",' + points[nextPoint][2]+	'~';
	
	try{
		strtmp += points[nextPoint-vector][2] ;
	}catch(e){
		strtmp += "null";
	}
	
	addLog(strtmp);
}

function addLog(str){
	var now = new Date();
	timeStr = now.getDate()+"_"+now.getHours()+":"+now.getMinutes() +":"+ now.getSeconds();
	// timeStr = new Date().toISOString();
	localStorage.insertCoord = timeStr+", "+ str +"<br/>"+ localStorage.insertCoord;
	ins.innerHTML = localStorage.insertCoord;
}


function newSpace(){	
/**計算適當的繪圖位置
	找出所有點分佈範圍的邊界值, 算中心點及比例
*/
 /*
 for(p in points){
	points[p][0] = Math.round(points[p][0], 5);
	points[p][1] = Math.round(points[p][1], 5);
 }
 */
 	//找出四邊的點以算出放大值zoom
var maxN = points[0][0];
var maxS = points[0][0];
var maxE = points[0][1];
var maxW = points[0][1];

for(p in points){
	if(points[p][0] > maxN) maxN = points[p][0];
	if(points[p][0] < maxS) maxS = points[p][0];
	if(points[p][1] > maxE) maxE = points[p][1];
	if(points[p][1] < maxW) maxW = points[p][1];
}

	if((maxN - maxS) >(maxE - maxW)){	//比較長與寛,較大者的拿來算比例
		zoom = canvas.height * 0.9/(maxN - maxS);
	}else{
		zoom = canvas.width * 0.9/(maxE - maxW);
	}
	zoom0 = zoom;
	centerCoords0[0] = (maxN + maxS)/2;
	centerCoords0[1] = (maxE + maxW)/2;

	centerCoords[0] = centerCoords0[0];
	centerCoords[1] = centerCoords0[1];
}

function touchStart(e){
	gesturesStart(e.targetTouches[0].pageX,e.targetTouches[0].pageY);
	e.preventDefault();//避免觸發 click()
}

function mouseDown(e){
	gesturesStart(e.pageX, e.pageY);
	e.preventDefault();
}

function gesturesStart(x,y){
//	showMsg("gesturesStart()");
		//手勢起始位置在九宮格中央才會運作
		var recentTime = new Date().getTime();
		
		if(x > canvas.width/3 && x <canvas.width*2/3 && y > canvas.height/3 && y < canvas.height*2/3){
				//上一行以乎可以用inner區塊的方法
			if(recentTime - oldClickTimes < 300){		//double click的間隔
				//縮放模式
				enGestures = true;
//				console.log("enGestures=" + enGestures);
				zoom1 = zoom;
				//ctx.beginPath();
				//ctx.moveTo(x, y);
				startGestX = x;
				startGestY = y;
			}else{
				//移動模式
			
			}
		}
		//移動
}

	var endGestX = -1; 
	var endGestY = -1;
function gesturesMove(x, y){
//	showMsg("gesturesMove()");
	endGestX = x;
	endGestY = y;
	if(enGestures && zoom>= zoom0/3){		//縮小不能小於1/3。那放大呢???
		 myCanvas.drawClearMap();
		 zoom =zoom1 *(1+(y-startGestY)*0.01);
		 if(zoom < zoom0/3)zoom = zoom0/3;
		 myCanvas.drawMiddleCross();
		 myCanvas.drawBaseMap();
	 }
}

function touchMove(e){
	gesturesMove(e.targetTouches[0].pageX,e.targetTouches[0].pageY);
	e.preventDefault();
}

function mouseMove(e){
	gesturesMove(e.pageX,e.pageY);
	e.preventDefault();
}

function gesturesEnd(){
	if(enGestures){
		enGestures = false;
	}else{
		gridCmd(endGestX, endGestY);
	}
}

function touchEnd(e){
	gesturesEnd();
	e.preventDefault();
}

function mouseUp(e){
	gesturesEnd();
	e.preventDefault();
}

async function noSleep(){	
//不自動休眠, Note9 chrome 92.0.4515.131有效, 但三星browser 16.0.6.23無作用。
	// The wake lock sentinel.
	let wakeLock = null;
	// Function that attempts to request a screen wake lock.
	const requestWakeLock = async () => {
		try {
			wakeLock = await navigator.wakeLock.request('screen');
			wakeLock.addEventListener('release', () => {
				//console.log('Screen Wake Lock was released');
			});
		//console.log('Screen Wake Lock is active');
		//alert("NoSleep");
		} catch (err) {
			console.error(`${err.name}, ${err.message}`);
		}
	};
	// Request a screen wake lock…
	await requestWakeLock();
}


function click(e){	//觸發座標為滑鼠放開處
	e.preventDefault();
	document.getElementById("watchStr").innerHTML="click()";
	//var x = event.pageX;
	//var y = event.pageY;
	gridCmd(e.pageX, e.pageY);
}

function gridCmd(x,y){
	if(document.getElementById("touchSW").checked){
		
	}else{
		return;
	}
//showMsg("gridCmd(), x=" + x +", y=" +y);
	var gridW = canvas.width/3;
	var gridH = canvas.height/3;
	oldClickTimes = new Date().getTime();
	
	if(x > gridW*2 && x < canvas.width-50 && y > gridH*2){	//右下角
	//&& x < canvas.width-50 用來避免note 9 的圓邊誤觸
		// taskID ++;
		if (++taskID == tasks.length) {
			taskID = 0;
		}
		nextPoint = 0;
		initTask();
		playVoice("當");
		return;
	}

		if(x > gridW*2 && x < canvas.width-50 && y < gridH){//右上角
			//&& x < canvas.width-50 用來避免note 9 的圓邊誤觸

			if(skipPoint()){	//手動跳一點, 差太多點則切換方向重找最近點
				playVoice("跳過");
				// edgeVector = getAzimuth(points[nextPoint-vector],  points[nextPoint]);
				showData();
			}else{
				showMsg("端點");
				searchPoint = true;
			}
				//
			// searchPoint = true;
			return;
		}
		
		if(x < gridW && x > 50 && y < gridH){//左上角
			//console.log("左上角_去回切換");
			vectorMode();
			return;
		}
		
		if(x < gridW && x > 50 && y > gridH*2){	//左下角
			//console.log("左下角_測試音效");
			viewSW();
			return;
		}
	}

function vectorMode(){
	
	vector *=-1;
	console.log("vector swith to " + vector);
	nextPoint += vector;
	if(nextPoint == -1 || nextPoint == points.length){
		showMsg("vectorMode():端點");
	}else{
		const vStr = ["回程",,"去程"];
		// playVoice(vStr[1+vector]);
		showData();
	}
}

function vectorMode_(){
	if(vector ==1){
		vector = -1;//回程
		nextPoint = points.length-1;
		playVoice("回程");
	}else{
		vector = 1;//去程
		nextPoint = 0;
		playVoice("去程");
	}
	// searchPoint =true;
	showData();
}

function viewSW(){
	viewMode *= -1;		//兩種模式切換
		myCanvas.drawClearMap();
	if(viewMode == 1){
		playVoice("全圖");
		centerCoords[0] = centerCoords0[0];
		centerCoords[1] = centerCoords0[1];
		zoom = zoom0;
	}else{		
		playVoice("置中");
		centerCoords[0] = recentPoint[0];
		centerCoords[1] = recentPoint[1];
		myCanvas.drawMiddleCross();
	}

	myCanvas.drawBaseMap();	
}

function playVoice(str){
	//語音來源：22/1/30雅婷文字轉語音下載wav檔, https://tts.yating.tw/
	//其它：google翻譯,可透過SoundOfText網站下載, 或自己用DevTools下載mp3
	if(str == undefined) return ;
	
	var fileName = "../voice/"+ str+".wav";
		voice.src = fileName;
		_todo._750找不到語音檔要報錯_並播放其它 = function(){}	//AAAAAAAA
		try {
			voice.load();
			voice.play();
		}catch (e) {	//完全抓不到error
			showMsg(e);
		}
}

function initTask(){
	//任務切換
	//nextPoint = 0;
	nextDist = -1;
	preDist = 0;
	incDistCnt = 0
	vector = 1;
	viewMode = 1;

	localStorage.taskID = taskID;
	// taskID = localStorage.taskID ? localStorage.taskID-1 : taskID;
	

	points = tasks[taskID];
	
	newSpace();
	myCanvas.drawClearMap();
	myCanvas.drawBaseMap();
	
	showData();
}	

function skipPoint(){
showMsg("a1");
	if(points[nextPoint][4-vector]){
		playVoice("通過");
	}
	passPoint[0] = points[nextPoint][0];
	passPoint[1] = points[nextPoint][1];
		enAlarm = true;
	enAlarmHigh = true;		
	showMsg("a2");
	
		edgeVector = getAzimuth(points[nextPoint],  points[nextPoint+vector]);	
		diff = Math.abs(coords_heading - edgeVector); 
		strtmp = ", " + Math.round(coords_heading) + 
						", " + Math.round(edgeVector) + 
						", " + Math.round(diff);
	
	if( points[nextPoint][4] && points[nextPoint][4].indexOf("s") >= 0){
		// addLog("尋標(s)"+ strtmp);
		if(diff > 30 && diff < 330){
			addLog("尋標(偏離)" + strtmp);
			searchPoint = true;
			return false;
		}
	}
		nextPoint += vector;//****************************


	
showMsg("a3");	
	if(nextPoint == -1 || nextPoint == points.length){
		addLog("尋標(端點)");
		searchPoint = true;
		return false;
	}
	showMsg("a4");
	addLog(points[nextPoint][2]+ strtmp);
	myCanvas.drawPoint(points[nextPoint][0], points[nextPoint][1], "white", 2);
	preDist = getDistance(recentPoint,  points[nextPoint]);

	return true;
}	

myCanvas.drawClearMap = function (){
	ctx.fillStyle = "black";	//填滿色
	ctx.fillRect(0,0,canvas.width,canvas.height);
	ctx.strokeStyle = "blue";	//線條色
	ctx.lineWidth = 2;	//線條粗度
	ctx.strokeRect(0,0,canvas.width,canvas.height);
	ctx.strokeRect(canvas.width/3,canvas.height/3,canvas.width/3,canvas.height/3);
}

myCanvas.drawMiddleCross = function(){
				//在畫面中央畫十字
		ctx.strokeStyle = "white";	//線條色
		ctx.lineWidth = "2";	//線條粗度
		ctx.beginPath();
		ctx.moveTo(centerX-20, centerY);
		ctx.lineTo(centerX+20, centerY);
		ctx.moveTo(centerX, centerY-20);
		ctx.lineTo(centerX, centerY+20);
		// start = Math.PI*(evt.coords.heading/180 - 0.5);
		// ctx.arc( centerX, centerY,10,start,start-Math.PI*2,true);
		ctx.stroke();
	
}

myCanvas.drawBaseMap = function(){
	 var mapPoints = gps2scr(points);
	
     var circle = new Path2D();		//綠色節點
	 var circle0 = new Path2D();	//紅色節點, 有語音者
	 var circle2 = new Path2D();	//所有節點中間填滿黑色
	 var path = new Path2D();
	 var circleTmp;
	 
 	for ( p=0;p< mapPoints.length;p++){		//TODO 改用Path2D物件
		if(points[p][4-vector]){
			circle0.moveTo(mapPoints[p][0], mapPoints[p][1]);
			circle0.arc(mapPoints[p][0], mapPoints[p][1],1,0,Math.PI*2,true);
					circle2.moveTo(mapPoints[p][0], mapPoints[p][1]);
		circle2.arc(mapPoints[p][0], mapPoints[p][1],1,0,Math.PI*2,true);
		}else{

					circle.moveTo(mapPoints[p][0], mapPoints[p][1]);
		circle.arc(mapPoints[p][0], mapPoints[p][1],1,0,Math.PI*2,true);
		}
			

		path.lineTo(mapPoints[p][0], mapPoints[p][1]);
	}
	ctx.lineJoin="round";	//轉折點的樣式, miter(default), round扇形
	ctx.strokeStyle = "Lime";	//鮮綠色
	ctx.lineWidth = 2;	//線條粗度
	ctx.stroke(path);
	
	ctx.strokeStyle = "Magenta";	//  粉紅色
	ctx.lineWidth = 2;	//線條粗度
	// ctx.stroke(circle);
	
	ctx.lineWidth = 2;	//線條粗度
	ctx.stroke(circle0);
	
	  ctx.lineWidth = 2;	//線條粗度
	ctx.fillStyle = "black";
	// ctx.fill(circle2);
	/*
	ctx.lineJoin="miter";	//轉折點的樣式, miter(default), round扇形 和 bevel三角形
ctx.miterLimit=5;		//最大斜接長度。斜接長度指的是在兩條線交匯處內角和外角之間的距離。

lineCap 線條端點的樣式, butt(default)方形, square 和 round圓形
setLineDash 方法和 lineDashOffset 屬性來制定虛線樣式
來源 https://kknews.cc/zh-tw/code/6azm5bl.html
	*/
}

function gps2scr(sourcePs){
	//經緯度座標「批次」轉螢幕座標
	//「假設」經緯度間隔等比例
	//但到時圖片貼上就偏了...
	var newPs=new Array();
	for(var i=0; i<sourcePs.length; i++){
		newPs[i] = new Array();
		newPs[i][0] =  (sourcePs[i][1] - centerCoords[1] )* zoom + centerX;
		newPs[i][1] = -(sourcePs[i][0] - centerCoords[0] )*zoom + centerY;
	}
	return newPs;
}

myCanvas.drawPoint=function (lat, lon, color, r){
	var drawX = (lon - centerCoords[1] )* zoom + centerX;
	var drawY = -(lat - centerCoords[0] )*zoom + centerY;
	//console.log(drawX + "," + drawY);
	ctx.strokeStyle = color;	//線條色
	ctx.lineWidth = "1";	//線條粗度
	ctx.beginPath();
    ctx.arc(drawX, drawY,r,0,Math.PI*2,true);
	ctx.stroke();
}

function nearPoint(){
	console.log("nearPoint(start)");

	// var shortstDist = getDistance(recentPoint,  tasks[0][0]);
	var bigAng = [0,0];
	var bigPoint=[0,0];
	var bigTask = [0,0];
	
	let minDiff=0;
	let bestV = 0;
	let oldTask = taskID;
    let bestP = 0;
	let bestT =0;
	
	for(var t=0; t < tasks.length; t++){
		for(var i=1; i < tasks[t].length; i++){
			 // showMsg(tasks[t][i-1][2]);
			//dist = getDistance(recentPoint,  tasks[t][i]);
			ang = angleOffset(recentPoint, tasks[t][i-1], tasks[t][i]);
				//所在「位置」與兩端夾角最大者
			if(ang > bigAng[0]){
				console.log("1st:"+ang+","+tasks[t][i][2]);
				bigAng[1] = bigAng[0];
				bigPoint[1]= bigPoint[0];
				bigTask[1] = bigTask[0];	
				
				bigAng[0] = ang;
				bigPoint[0] = i;
				bigTask[0] = t;
				continue;
			}
			
			if(ang > bigAng[1]){
				console.log("2st:"+ang +","+tasks[t][i][2]);
				bigAng[1] = ang;
				bigPoint[1]= i;
				bigTask[1] = t;	
			}
		}
	}
	/*
	console.log("1st:" + tasks[bigTask[0]][bigPoint[0]][2] +"," +bigTask[0]+","+bigPoint[0]);
	console.log("2nd:" + tasks[bigTask[1]][bigPoint[1]][2]+"," +bigTask[1]+","+bigPoint[1]);
	
	v=1;
minDiff = 361;
	for(k=0; k<2; k++){
		for(i=0; i<2; i++){
			for(j=0; j<2; j++){
				
				edgeVector = getAzimuth(
					tasks[bigTask[k]][bigPoint[i]-v],  
					tasks[bigTask[k]][bigPoint[i]]);	
				diff = Math.abs(coords_heading - edgeVector); 
				console.log(diff+"," + tasks[bigTask[k]][bigPoint[i]][2]+"," +bigTask[k]+","+bigPoint[i]);
				if(diff < minDiff){
					minDiff=diff;
					bestV = v;
					bestP = bigPoint[i];
					bestT = bigTask[k];
				}
				v *= -1;
			}
		}
	}
	
	console.log("best:" + tasks[bestT][bestP][2]);
	*/
	bestP = bigPoint[0];
	bestT = bigTask[0];
	nextPoint = bestP;
	taskID = bestT;

	if(taskID != oldTask){
		initTask();
		playVoice('新任務');
	}
	
	preDist = getDistance(recentPoint,  points[nextPoint]);
	/*
	if(vector != bestV){
		vectorMode();
	}
*/

	edgeVector = getAzimuth(points[nextPoint-vector],  points[nextPoint]);	
	diff = Math.abs(coords_heading - edgeVector); 
	strtmp = "gps:"+ Math.round(coords_heading) + ", edge:" + Math.round(edgeVector);
	if(diff > 90 && diff < 270){
		strtmp += ",轉向";
		vectorMode();
	}
	strtmp = "新目標:" + points[nextPoint][2];// + strtmp;
	addLog(strtmp);
	// showMsg("nP(8)");
}

function geoYes (evt){
	showMsg("c1");
	strGPS = strGPS.substr(1,3)+strGPS.charAt(0);

	// if( evt.coords.speed <=0){	//沒有移動, 不處置???
			// coords_speed = -1;
			// coords_heading = -1;
			// return;
	// }

	recentPoint[0] = evt.coords.latitude;
	recentPoint[1] = evt.coords.longitude;
	coords_heading = evt.coords.heading;
	coords_speed = evt.coords.speed;
	showMsg("c1.5");
	// showMsg("geoYes(3)");
	if(searchPoint ){
		nearPoint();
		searchPoint = false;
	}
	
	// showMsg("geoYes(5)");
	if(viewMode == 1){		//全圖：只畫點
		myCanvas.drawPoint(recentPoint[0], recentPoint[1], "white", 2);
	}else{		//置中：全重畫, 不畫點
		centerCoords[0] = recentPoint[0];
		centerCoords[1] = recentPoint[1];
		myCanvas.drawClearMap();
		myCanvas.drawMiddleCross();
		myCanvas.drawBaseMap();
	}

// showMsg("geoYes(7)");
	_todo._250判定脫離路線 = function(){}	//AAAAAAAA
	_todo._220搜尋新路線 = function(){}	//手動鈕, 用角度與距離搜尋
	_todo._230判定順逆向 = function(){}	//AAAAAAAA
	//需要判定的項目
	//1.通過點, 才能繼續導航
	//2.提醒,及高速提醒
	//3.路線切換 ???
	//4.沒在路線上不可亂報, (夾角不到170)
	showMsg("c2");
	fcolor = "";
	nextDist = getDistance(recentPoint,  points[nextPoint]);
	if (nextDist > preDist ){	//遠離中
		if(nextDist < evt.coords.speed/1000 * 2 + 0.015 ){
			//近距離內(車速的2秒),判定為通過。車速較高時會抓不到。
			//分角線判定法
			showMsg("c3");
			window.setTimeout(skipPoint, 1000);//等轉彎完成
		}else{
			fcolor = "color='red'";
		}
	}else{		//接近中
		playAlarm();
	}
	
	showMsg("c3");
	showData();
	preDist = nextDist;
	// showMsg("init(e)");
}

function playAlarm(){
	showMsg("b1");
	// if(enAlarmHigh && nextDist < 2 && evt.coords.speed*3.6 >70){
						//時速70以上, 2公里前提醒一次
	vocStr = points[nextPoint][4-vector];
	
	if( vocStr == "交流道" && enAlarmHigh && nextDist < 2){
		showMsg("b2");
		playVoice(vocStr);
		enAlarmHigh = false;
	}
		/** 事前提醒*/
		//時速60公里 = 60x1000/60x60 = 60/3.6 = 16.6公尺/秒(步行4公里/小時)
		//車速每10公里提前2秒通知：
		//		120公里提前24秒, 33*24=792
		//		30公里時提前6秒通知,約8.1*6=48公尺。
		//		10公里,3秒,約4.1*3公尺,。
		//最後加12公尺給單車時,路中與路邊的距離補償用
		
	if(enAlarm ){
		minDist = coords_speed/1000 * coords_speed*3.6/10*2 + 0.015;
		if(nextDist < 0.05 || nextDist < minDist){
			showMsg("b3");
			playVoice(vocStr);
			enAlarm = false;
		}
	}
	showMsg("b4");
}

function _geoNo(evt){
	/*
		TODO 本函式塞到 watchPosition內。
		限https? win10本機檔用Chrome可開允許,但仍取得失敗。 手機note9待測
		Only secure origins are allowed 安全來源才可用geo...
		https://kknews.cc/zh-tw/tech/4qgkxq2.html
	*/
	if(evt.code == 1){
		showMsg("GPS未允用！");
	}else{
		showMsg(evt.code + ", " + evt.message);
	}
}

var watchID;
function startGPS(){
	//showMsg("startGPS()");
	if (!navigator.geolocation) {
		showMsg("GPS不支援。");
		return;
	}

		// navigator.geolocation.getCurrentPosition( geoYes, geoNo);
	navigator.permissions.query({name:'geolocation'}).then(function(result) {
		//權限判斷以乎對重覆檢查GPS是否啟用沒有關聯。
		if (result.state == 'denied') {	//denied禁用, prompt詢問, granted允許
			showMsg("GPS禁用！");
		}
		result.onchange = function() {
		}
	});
	/*
	var options = {
	  enableHighAccuracy: true,	//高精度, 實測更新間隔約1秒, 否則約20秒。
	  timeout: 5000,						//在note9用chrome會Timeout expired。
	  maximumAge: 0						//快取的過期時間，單位是毫秒，設為0來禁用快取讀取。
	};
	*/
	watchID = navigator.geolocation.watchPosition(geoYes, 
		//就算成功, 但中途失敗不會告知?
		(evt) =>{
				if(evt.code == 1){
					showMsg("GPS沒開！");	//User denied Geolocation
					//失敗後就不管了, 如何每秒檢查一次?
				}else{
					showMsg(evt.code + ", " + evt.message);
					//2, Network location provider at 'https://www.googleapis.com/' : ERR_NAME_NOT_RESOLVED
				}
		}, {enableHighAccuracy: true});
}

function stopGPS(){
	navigator.geolocation.clearWatch( watchID );
	showMsg("GPS停止定位。");
}

function getDistance(coord1, coord2) {
	//兩座標間的距離, 傳回：單位公里, 小數點後三位
    //本函式來源 https://www.geodatasource.com/developers/javascript
	lat1	= coord1[0].toFixed(5);	//用小數5位算距離
	lon1= coord1[1].toFixed(5);
	lat2	= coord2[0].toFixed(5);
	lon2= coord2[1].toFixed(5);
	
    var radlat1 = Math.PI * lat1/180;
    var radlat2 = Math.PI * lat2/180;
    var theta = lon1-lon2;
    var radtheta = Math.PI * theta/180;
    var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
    if (dist > 1) {
        dist = 1;
    }
    dist = Math.acos(dist);
    dist = dist * 180/Math.PI;
    dist = dist * 60 * 1.1515;	//不明常數
    dist = dist * 1.609344 ;		//英浬轉公里

    return dist.toFixed(3);		//小數點後三位(四捨「六入」)
}
	var fcolor = "";
	var strGPS = "\|/-";	//
function showData(){
	// showMsg("showData:nextPoint=" + nextPoint);
		str="";
		str += strGPS.charAt(0);
		voiceStr = points[nextPoint][4-vector];
		if(voiceStr){
			str += "[" + voiceStr + "]";
		}else{
			str += "[x]";
		}			
		
		str += ", <font "+ fcolor+">" ;
		str += (nextDist < 1) ? (+ nextDist*1000+"</font>公尺") : (Math.round(nextDist)+"</font>公里");

		arriveSec =  nextDist*1000/coords_speed;
		if(arriveSec < 99){
			str += "，" + arriveSec.toFixed(0)+"秒";
		}
		
		index = points[0][2].indexOf("_");
		if(index < 0){
			index = points[0][2].length;
		}
		str += "<br/>" + points[nextPoint][2] + "(" + points[0][2].substr(0,index)+")";
		if(coords_speed > 1){
			str += "<br/>時速："+ (coords_speed*3.6).toFixed(1) + "公里，";	//原單位：米/秒
		}
		// str += Math.round(coords_heading) +"度";	//12點鐘方向為0, 順時針~360
		// str += "(路段：" + edgeVector.toFixed() + "度)";
		
		// if(vector ==1){	//去程
			// tmp0 = 0;
			// tmp1 = points.length-1;
		// }else{
			// tmp0 = points.length-1;
			// tmp1 = 0;
		// }
		
		/*
		dA = angleOffset(recentPoint,passPoint,points[nextPoint]);
		str += "<br>夾角：<font color='";
		if(dA.toFixed() < 160){
			str += "red";
		}else{
			str += "lime";
		}
		str +="'>" + dA.toFixed() + "</font>";
		*/
		document.getElementById("posStr").innerHTML=str;

// console.log("showData(e)");
}

var msgList = ["","","","","","","","","",""];
var msgID = 0;

function  showMsg(str){
	msgList[msgID] = str;
	output = msgList[msgID] + "<br/>";

	for(i=msgID+1; i < msgList.length; i++){
		output += msgList[i] + "。";
	}
	for(i=0; i < msgID; i++){
		output += msgList[i] + "。";
	}
	// console.log(output);
	document.getElementById("watchStr").innerHTML= output;
	
	msgID --;	//新的訊息放前面
	if(msgID < 0){
		msgID = msgList.length - 1;
	}
}

function newCache(){
			cache.delete('.');
		cache.delete('index.html');
	//將"gps"快取中的key全部刪除
	/*
	caches.open('gps')
		.then(function(cache) {
			cache.keys()
			.then(function(keys) {
				keys.forEach(function(request, index, array) {
					cache.delete(request);
				});
			});
		});
	*/	
}

function displayNotification(){
    if('serviceWorker' in navigator){
        var options = {
            body: '歡迎進入30天PWA的世界'           
        };
        navigator.serviceWorker.ready
            .then(function(sw){
                sw.showNotification('訂閱成功！！！', options);
            })
    }  else{
		
	}
     
}

var IntervalID;
var isMarch = -1;
var march = document.getElementById("march");
var timeNum = [40,,60];	//TODO 連續號誌使用同一時序。轉向時兩個值互換。
var colorList = ["red",,"lime"];	//萊姆色
/**紅綠燈讀秒, 時間到或用戶點選時會變色及重數 */

function swColor(){

	//初始綠色靜止秒數零, 按一下開始增加, 
	//按一下(記錄綠色秒數G3)變紅且從零增加,
	//再按一下(記錄G3R40)變綠且從零增加
	//跳點後,存檔G3R40G24,畫面回復初始狀態
	//看到燈號時按一下, 再按一下變更顏色,倒數, 下一點時間不同則要回復初始狀態
	if(!IntervalID){
		IntervalID = window.setInterval(( () =>  {
			//休眠狀態將回調函數放在隊列中,等瀏覽器再次打開的時候，一瞬間全部執行
			if(count < 0){
				isMarch *= -1;
				count = timeNum[1+isMarch];
				march.style.color = colorList[1+isMarch];
				// march.innerText = count;
			}
			march.innerText = count--;
			
		}	) , 1000);
		count = timeNum[1+isMarch];
		march.style.color = colorList[1+isMarch];
		march.innerText = count--;
	}else{
		isMarch *= -1;
		count = timeNum[1+isMarch];
		march.style.color = colorList[1+isMarch];
		march.innerText = count;
	}
}

	_todo._510紅綠燈記錄 = function(){}	
	_todo._520紅綠燈讀秒 = function(){}	
function exportCoord(){
//座標清單匯出檔案,再用Http_file_server傳到電腦
  var fileName = "a.csv";//匯出的檔名
  var data = ins.innerHTML;	//TODO 要把BR改成\n\r
  var blob = new Blob([data], {
    type : "application/octet-stream"
  });
  //實作一個標簽, 好像不正規。
  var href = URL.createObjectURL(blob);
  var link = document.createElement("a");
  document.body.appendChild(link);
  link.href = href;
  link.download = fileName;
  link.click();
}

//document.getElementById('input').click();
// document.getElementById("fileInput").onchange = () => {
  // const selectedFiles = [...fileInput.files];
  // console.log(selectedFiles);
// }

/**
	程式功能：手機/GPS, 於特定路線上目標點提示路況(提早放油門, 減少煞車)
	目標1：山路有坑洞與急彎要提前通知
		資料源：除用gmap取得座標,內建路徑, 移動中要即時記錄,儲存(小數後七位不夠)
			儲存：csv匯入indexDB, 插入, 匯出
				設定：5個按鈕直接顯示在畫面上, 開車者要去按。
					暫時方案：存到本地變數
		語音：先上網下載並cache。之後可自行錄音, 存到cache
				
		
	目標2：平面道路紅綠燈讀秒(先手動)
	目標3：提醒下交流道???
	
	必要條件：GPS沒開要持續watch, 中途沒GPS要提示, 卡住了
	
	錯誤處理：
		手機上的文字大小會變動???
*/
</script>
</html>